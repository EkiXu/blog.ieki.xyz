(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{375:function(s,a,n){"use strict";n.r(a);var t=n(3),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"golang-项目结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#golang-项目结构"}},[s._v("#")]),s._v(" Golang 项目结构")]),s._v(" "),a("p",[s._v("这一部分的内容主要来自于 github 的高星项目："),a("a",{attrs:{href:"https://github.com/golang-standards/project-layout/blob/master/README_zh.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("golang-standards/project-layout"),a("OutboundLink")],1),s._v(" 通过这个我们可以大概的了解到在 Go 中一些约定俗成的目录含义，虽然这些不是强制性的，但是如果有去看官方的源码或者是一些知名的项目可以发现大多都是这么命名的，所以我们最好和社区保持一致，大家保持同样的语言。")]),s._v(" "),a("p",[s._v("以go-gin-api为例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(".\n├── assets\n│   ├── bootstrap\n│   │   ├── css\n│   │   ├── fonts\n│   │   ├── images\n│   │   │   └── users\n│   │   └── js\n│   └── templates\n│       ├── admin\n│       ├── authorized\n│       ├── configinfo\n│       ├── cron_task\n│       ├── dashboard\n│       ├── generator\n│       ├── index\n│       ├── install\n│       ├── menu\n│       └── tool\n├── cmd\n│   ├── gormgen\n│   │   └── pkg\n│   ├── handlergen\n│   ├── mfmt\n│   └── mysqlmd\n│       └── mysql\n├── configs\n├── deployments\n│   ├── loki\n│   └── prometheus\n├── docs\n├── internal\n│   ├── alert\n│   ├── api\n│   │   ├── admin\n│   │   ├── authorized\n│   │   ├── config\n│   │   ├── cron\n│   │   ├── helper\n│   │   ├── menu\n│   │   └── tool\n│   ├── code\n│   ├── graph\n│   │   ├── generated\n│   │   ├── handler\n│   │   ├── model\n│   │   ├── resolvers\n│   │   │   └── generated\n│   │   └── schemas\n│   ├── metrics\n│   ├── pkg\n│   │   ├── core\n│   │   ├── password\n│   │   └── validation\n│   ├── proposal\n│   │   └── tablesqls\n│   ├── render\n│   │   ├── admin\n│   │   ├── authorized\n│   │   ├── config\n│   │   ├── cron\n│   │   ├── dashboard\n│   │   ├── generator\n│   │   ├── index\n│   │   ├── install\n│   │   ├── tool\n│   │   └── upgrade\n│   ├── repository\n│   │   ├── cron\n│   │   ├── mysql\n│   │   │   ├── admin\n│   │   │   ├── admin_menu\n│   │   │   ├── authorized\n│   │   │   ├── authorized_api\n│   │   │   ├── cron_task\n│   │   │   ├── menu\n│   │   │   └── menu_action\n│   │   ├── redis\n│   │   └── socket\n│   ├── router\n│   │   └── interceptor\n│   ├── services\n│   │   ├── admin\n│   │   ├── authorized\n│   │   ├── cron\n│   │   └── menu\n│   └── websocket\n│       └── sysmessage\n├── logs\n├── pkg\n│   ├── aes\n│   ├── browser\n│   ├── color\n│   ├── ddm\n│   ├── debugs\n│   ├── env\n│   ├── errors\n│   ├── file\n│   ├── hash\n│   ├── httpclient\n│   ├── logger\n│   ├── mail\n│   ├── rsa\n│   ├── shutdown\n│   ├── signature\n│   ├── timeutil\n│   ├── trace\n│   └── urltable\n└── scripts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br")])]),a("h3",{attrs:{id:"cmd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[s._v("#")]),s._v(" /cmd")]),s._v(" "),a("p",[s._v("我们一般采用 "),a("code",[s._v("/cmd/[appname]/main.go")]),s._v(" 的形式进行组织")]),s._v(" "),a("ul",[a("li",[s._v("首先 cmd 目录下一般是项目的主干目录")]),s._v(" "),a("li",[s._v("这个目录下的文件"),a("strong",[s._v("不应该有太多的代码，不应该包含业务逻辑")])]),s._v(" "),a("li",[s._v("main.go 当中主要做的事情就是负责程序的生命周期，服务所需资源的依赖注入等，其中依赖注入一般而言我们会使用一个依赖注入框架，这个主要看复杂程度，后续会有一篇文章单独介绍这个")])]),s._v(" "),a("h3",{attrs:{id:"internal"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#internal"}},[s._v("#")]),s._v(" /internal")]),s._v(" "),a("p",[s._v("internal 目录下的包，不允许被其他项目中进行导入，这是在 Go 1.4 当中引入的 feature，会在编译时执行")]),s._v(" "),a("ul",[a("li",[s._v("所以我们一般会把项目文件夹放置到 internal 当中，例如 "),a("code",[s._v("/internal/app")])]),s._v(" "),a("li",[s._v("如果是可以被其他项目导入的包我们一般会放到 pkg 目录下")]),s._v(" "),a("li",[s._v("如果是我们项目内部进行共享的包，而不期望外部共享，我们可以放到 "),a("code",[s._v("/internal/pkg")]),s._v(" 当中")]),s._v(" "),a("li",[s._v("注意 internal 目录的限制并不局限于顶级目录，在任何目录当中都是生效的")])]),s._v(" "),a("h3",{attrs:{id:"pkg"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pkg"}},[s._v("#")]),s._v(" /pkg")]),s._v(" "),a("p",[s._v("一般而言，我们在 pkg 目录下放置可以被外部程序安全导入的包，对于不应该被外部程序依赖的包我们应该放置到 "),a("code",[s._v("internal")]),s._v(" 目录下， "),a("code",[s._v("internal")]),s._v(" 目录会有编译器进行强制验证")]),s._v(" "),a("ul",[a("li",[s._v("pkg 目录下的包一般会按照功能进行区分，例如 "),a("code",[s._v("/pkg/cache")]),s._v(" 、 "),a("code",[s._v("/pkg/conf")]),s._v(" 等")]),s._v(" "),a("li",[s._v("如果你的目录结构比较简单，内容也比较少，其实也可以不使用 "),a("code",[s._v("pkg")]),s._v(" 目录，直接把上面的这些包放在最上层即可")]),s._v(" "),a("li",[s._v("一般而言我们应用程序 app 在最外层会包含很多文件，例如 "),a("code",[s._v(".gitlab-ci.yml")]),s._v(" "),a("code",[s._v("makefile")]),s._v(" "),a("code",[s._v(".gitignore")]),s._v(" 等等，这种时候顶层目录会很多并且会有点杂乱，建议还是放到 "),a("code",[s._v("/pkg")]),s._v(" 目录比较好")])]),s._v(" "),a("h3",{attrs:{id:"config-s"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#config-s"}},[s._v("#")]),s._v(" /config(s)")]),s._v(" "),a("p",[s._v("为什么加个(s) 是课上讲的还有参考材料中很多都叫 configs 但是我们习惯使用 config 但是含义上都是一样的\n这里面一般放置配置文件文件和默认模板")]),s._v(" "),a("h3",{attrs:{id:"test"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test"}},[s._v("#")]),s._v(" /test")]),s._v(" "),a("p",[s._v("额外的外部测试应用程序和测试数据。一般会放测试一些辅助方法和测试数据")]),s._v(" "),a("h3",{attrs:{id:"build"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[s._v("#")]),s._v(" build")]),s._v(" "),a("p",[a("strong",[s._v("打包和持续集成")]),s._v("所需的文件。")]),s._v(" "),a("ul",[a("li",[s._v("build/ci：存放持续集成的配置和脚本，如果持续集成平台对配置文件有路径要求，则可将其 link 到指定位置。")]),s._v(" "),a("li",[s._v("build/package：存放 AMI、Docker、系统包（deb、rpm、pkg）的配置和脚本等。")])]),s._v(" "),a("p",[s._v("例子：")]),s._v(" "),a("ul",[a("li",[s._v("https://github.com/cockroachdb/cockroach/tree/master/build")])]),s._v(" "),a("h3",{attrs:{id:"configs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configs"}},[s._v("#")]),s._v(" configs")]),s._v(" "),a("p",[s._v("配置文件模板或默认配置。")]),s._v(" "),a("h3",{attrs:{id:"deployments"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deployments"}},[s._v("#")]),s._v(" deployments")]),s._v(" "),a("p",[s._v("IaaS，PaaS，系统和容器编排部署配置和模板（docker-compose，kubernetes/helm，mesos，terraform，bosh）。请注意，在某些存储库中（尤其是使用 kubernetes 部署的应用程序），该目录的名字是 "),a("strong",[s._v("/deploy")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"init"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#init"}},[s._v("#")]),s._v(" init")]),s._v(" "),a("p",[s._v("系统初始化（systemd、upstart、sysv）和进程管理（runit、supervisord）配置。")]),s._v(" "),a("h3",{attrs:{id:"scripts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scripts"}},[s._v("#")]),s._v(" scripts")]),s._v(" "),a("p",[s._v("用于执行各种构建，安装，分析等操作的脚本。")]),s._v(" "),a("p",[s._v("这些脚本使根级别的 Makefile 变得更小更简单，例如：https://github.com/hashicorp/terraform/blob/master/Makefile。")]),s._v(" "),a("h3",{attrs:{id:"test-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#test-2"}},[s._v("#")]),s._v(" test")]),s._v(" "),a("p",[a("strong",[s._v("外部测试应用程序和测试数据")]),s._v("。随时根据需要构建 "),a("code",[s._v("/test")]),s._v(" 目录。对于较大的项目，有一个数据子目录更好一些。例如，如果需要 Go 忽略目录中的内容，则可以使用 "),a("code",[s._v("/test/data")]),s._v(" 或 "),a("code",[s._v("/test/testdata")]),s._v(" 这样的目录名字。请注意，Go 还将忽略以“.”或“_”开头的目录或文件，因此可以更具灵活性的来命名测试数据目录。")]),s._v(" "),a("h3",{attrs:{id:"assets"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#assets"}},[s._v("#")]),s._v(" assets")]),s._v(" "),a("p",[s._v("项目中使用的其他资源（图像、logo 等）。")]),s._v(" "),a("h3",{attrs:{id:"docs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docs"}},[s._v("#")]),s._v(" docs")]),s._v(" "),a("p",[a("strong",[s._v("设计和用户文档")]),s._v("（除了 godoc 生成的文档）。")]),s._v(" "),a("h3",{attrs:{id:"examples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[s._v("#")]),s._v(" examples")]),s._v(" "),a("p",[s._v("应用程序或公共库的示例程序。")]),s._v(" "),a("h3",{attrs:{id:"githooks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#githooks"}},[s._v("#")]),s._v(" githooks")]),s._v(" "),a("p",[s._v("Git 钩子。")]),s._v(" "),a("h3",{attrs:{id:"third-party"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#third-party"}},[s._v("#")]),s._v(" third_party")]),s._v(" "),a("p",[s._v("外部辅助工具，fork 的代码和其他第三方工具（例如：Swagger UI）。")]),s._v(" "),a("h3",{attrs:{id:"tools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tools"}},[s._v("#")]),s._v(" tools")]),s._v(" "),a("p",[s._v("此项目的支持工具。请注意，这些工具可以从 "),a("code",[s._v("/pkg")]),s._v(" 和 "),a("code",[s._v("/internal")]),s._v(" 目录导入代码。")]),s._v(" "),a("h2",{attrs:{id:"应该避免的坏习惯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应该避免的坏习惯"}},[s._v("#")]),s._v(" 应该避免的坏习惯")]),s._v(" "),a("h3",{attrs:{id:"src"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#src"}},[s._v("#")]),s._v(" /src")]),s._v(" "),a("p",[s._v("一般而言，在 Go 项目当中不应该出现 src 目录，Go 和 Java 不同，在 Go 中每一个目录都是一个包，每一个包都是一等公民，我们不需要将项目代码放到 src 当中，不要用写其他语言的方式来写 Go")]),s._v(" "),a("h3",{attrs:{id:"utils-common"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#utils-common"}},[s._v("#")]),s._v(" utils，common")]),s._v(" "),a("p",[s._v("不要在项目中出现 utils 和 common 这种包，如果出现这种包，因为我们并不能从包中知道你这个包的作用，长久之后这个包就会变成一个大杂烩，所有东西都往这里面扔。\n有的同学这个时候会问说，那我们的工具函数应该放到哪里？怎么放？\n举个例子，我们当前使用 "),a("code",[s._v("gin")]),s._v(" 作为路由框架，但是 "),a("code",[s._v("gin")]),s._v(" 的 handler 注册其实不是很方便，所以我们做了一层封装，这个时候这个工具方法我们一般放在 "),a("code",[s._v("/pkg/ginx")]),s._v(" 目录下，表示这个是对 "),a("code",[s._v("gin")]),s._v(" 增强的包，不直接使用 "),a("code",[s._v("gin")]),s._v(" 作为包名的原因是因为我们在项目中也会引用 "),a("code",[s._v("gin")]),s._v(" 相同的命名一个是会导致误解，另一个是在同时导入的时候也会需要去进行重命名会比较麻烦")]),s._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("p",[s._v("Go工程化(二) 项目目录结构 - Mohuishou：\nhttps://lailin.xyz/post/go-training-week4-project-layout.html")]),s._v(" "),a("p",[s._v("golang 编程规范 - 项目目录结构")]),s._v(" "),a("p",[s._v("https://makeoptim.com/golang/standards/project-layout")])])}),[],!1,null,null,null);a.default=e.exports}}]);